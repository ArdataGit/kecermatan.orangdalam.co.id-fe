{"version":3,"file":"PopupPlugin.js","sources":["../../src/popup/PopupPlugin.tsx"],"sourcesContent":["import React, { useLayoutEffect, useMemo, useRef, useState } from 'react';\nimport { createPopper, Instance, Placement } from '@popperjs/core';\nimport isString from 'lodash/isString';\nimport classNames from 'classnames';\nimport { CSSTransition } from 'react-transition-group';\nimport { render, unmount } from '../_util/react-render';\nimport { on, off, getAttach } from '../_util/dom';\nimport { TNode } from '../common';\nimport { TdPopupProps } from './type';\nimport useDefaultProps from '../hooks/useDefaultProps';\nimport { popupDefaultProps } from './defaultProps';\n\nexport interface PopupPluginApi {\n  config: TdPopupProps;\n}\n\ntype TriggerEl = string | HTMLElement;\n\nexport interface OverlayProps extends TdPopupProps {\n  triggerEl: TriggerEl;\n  renderCallback: (instance: HTMLElement) => void;\n}\n\nconst triggers = ['click', 'hover', 'focus', 'context-menu'] as const;\n\nlet popperInstance: Instance;\nlet overlayInstance: HTMLElement;\nlet timeout: NodeJS.Timeout;\nlet triggerEl: HTMLElement;\n\nconst componentName = 't-popup';\n\nconst triggerType = (triggerProps: string) =>\n  triggers.reduce(\n    (map, trigger) => ({\n      ...map,\n      [trigger]: triggerProps.includes(trigger),\n    }),\n    {} as Record<(typeof triggers)[number], boolean>,\n  );\n\nfunction getPopperPlacement(placement: TdPopupProps['placement']) {\n  return placement.replace(/-(left|top)$/, '-start').replace(/-(right|bottom)$/, '-end') as Placement;\n}\n\nconst Overlay: React.FC<OverlayProps> = (originalProps) => {\n  const props = useDefaultProps(originalProps, popupDefaultProps);\n  const {\n    trigger,\n    content,\n    showArrow,\n    disabled,\n    overlayInnerClassName,\n    hideEmptyPopup,\n    overlayClassName,\n    overlayStyle,\n    zIndex,\n    overlayInnerStyle,\n    renderCallback,\n  } = props;\n\n  const [visibleState, setVisibleState] = useState(false);\n  const popperRef = useRef<HTMLDivElement>();\n  const overlayRef = useRef<HTMLDivElement>();\n\n  const hidePopup = hideEmptyPopup && isString(content) && ['', undefined, null].includes(content);\n\n  const stylePoper = (): React.CSSProperties => {\n    let style = {};\n    if (hidePopup) {\n      style = { visibility: 'hidden', pointerEvents: 'none' };\n    }\n    return {\n      ...style,\n      zIndex,\n      ...overlayStyle,\n    };\n  };\n\n  // useMemo\n  const hasTrigger = useMemo(() => triggerType(trigger), [trigger]);\n  const overlayClasses = useMemo(\n    () => [\n      `${componentName}__content`,\n      {\n        [`${componentName}__content--text`]: content === 'string',\n        [`${componentName}__content--arrow`]: showArrow,\n        [`${componentName}-is-disabled`]: disabled,\n      },\n      overlayInnerClassName,\n    ],\n    [content, overlayInnerClassName, showArrow, disabled],\n  );\n\n  // method\n  const handleMouseLeave = () => {\n    setVisibleState(false);\n    removeOverlayInstance();\n    popperInstance?.destroy();\n    popperInstance = null;\n  };\n  const handleMouseEnter = () => {\n    if (timeout) {\n      clearTimeout(timeout);\n    }\n  };\n\n  const overlayInnerStyleMerge = () => {\n    if (!overlayInnerStyle || !triggerEl || !popperRef.current) {\n      return {};\n    }\n    if (typeof overlayInnerStyle === 'object') {\n      return overlayInnerStyle;\n    }\n    return overlayInnerStyle(triggerEl, popperRef.current);\n  };\n\n  // mounted\n  useLayoutEffect(() => {\n    setVisibleState(true);\n\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n\n  const eventProps = hasTrigger.hover && {\n    onMouseEnter: handleMouseEnter,\n    onMouseLeave: handleMouseLeave,\n    onMouseMove: handleMouseEnter,\n  };\n\n  // render node\n  const renderNode = (\n    <div\n      ref={(ref) => {\n        popperRef.current = ref;\n        renderCallback(ref);\n      }}\n      className={classNames([componentName, overlayClassName])}\n      style={stylePoper()}\n      {...eventProps}\n    >\n      <div ref={overlayRef} className={classNames(overlayClasses)} style={overlayInnerStyleMerge()}>\n        {content}\n        {showArrow && <div className={`${componentName}__arrow`}></div>}\n      </div>\n    </div>\n  );\n\n  return visibleState ? (\n    <CSSTransition appear timeout={0} in={visibleState} nodeRef={popperRef}>\n      {renderNode}\n    </CSSTransition>\n  ) : null;\n};\n\nfunction removeOverlayInstance() {\n  if (overlayInstance) {\n    unmount(overlayInstance);\n    overlayInstance.remove();\n    overlayInstance = null;\n  }\n  if (popperInstance) {\n    popperInstance.destroy();\n    popperInstance = null;\n  }\n}\n\nexport type PluginMethod = (triggerEl: TriggerEl, content: TNode, popupProps?: TdPopupProps) => Promise<Instance>;\n\nconst renderInstance = (props, attach: HTMLElement): Promise<HTMLElement> =>\n  new Promise((resolve) => {\n    render(<Overlay {...props} renderCallback={(instance) => resolve(instance)} />, attach);\n  });\n\nconst createPopupInstance: PluginMethod = async (trigger, content, popupProps) => {\n  const hasTrigger = triggerType(popupProps?.trigger || 'hover');\n  const currentTriggerEl = getAttach(trigger);\n  if (triggerEl && hasTrigger.click) {\n    return;\n  }\n  triggerEl = currentTriggerEl;\n  removeOverlayInstance();\n\n  let attach = getAttach(popupProps?.attach || 'body');\n\n  const delay = [].concat(popupProps?.delay ?? [250, 150]);\n  const closeDelay = delay[1] ?? delay[0];\n\n  if (attach === document.body) {\n    // don't allow mount on body directly\n    const popupDom = document.createElement('div');\n    document.body.appendChild(popupDom);\n    attach = popupDom;\n\n    overlayInstance = attach;\n  }\n\n  const instance = await renderInstance({ ...{ ...popupProps, content, triggerEl } }, attach);\n\n  if (hasTrigger.hover) {\n    const mouseoutEvent = () => {\n      timeout = setTimeout(removeOverlayInstance, closeDelay);\n      off(triggerEl, 'mouseleave', mouseoutEvent);\n    };\n    on(triggerEl, 'mouseleave', mouseoutEvent);\n  } else if (hasTrigger.focus) {\n    const focusoutEvent = () => {\n      timeout = setTimeout(removeOverlayInstance, closeDelay);\n      off(triggerEl, 'focusout', focusoutEvent);\n    };\n    on(triggerEl, 'focusout', focusoutEvent);\n  }\n\n  popperInstance = createPopper(triggerEl, instance, {\n    placement: getPopperPlacement(popupProps?.placement || ('top' as TdPopupProps['placement'])),\n    ...popupProps?.popperOptions,\n  });\n  return popperInstance;\n};\n\nconst PopupPlugin: PluginMethod = (trigger, content, popupProps) => createPopupInstance(trigger, content, popupProps);\n\nexport default PopupPlugin;\n"],"names":["triggers","popperInstance","overlayInstance","timeout","triggerEl","componentName","triggerType","triggerProps","reduce","map","trigger","_objectSpread","_defineProperty","includes","getPopperPlacement","placement","replace","Overlay","originalProps","props","useDefaultProps","popupDefaultProps","content","showArrow","disabled","overlayInnerClassName","hideEmptyPopup","overlayClassName","overlayStyle","zIndex","overlayInnerStyle","renderCallback","_useState","useState","_useState2","_slicedToArray","visibleState","setVisibleState","popperRef","useRef","overlayRef","hidePopup","isString","stylePoper","style","visibility","pointerEvents","hasTrigger","useMemo","overlayClasses","concat","handleMouseLeave","_popperInstance","removeOverlayInstance","destroy","handleMouseEnter","clearTimeout","overlayInnerStyleMerge","current","_typeof","useLayoutEffect","eventProps","hover","onMouseEnter","onMouseLeave","onMouseMove","renderNode","React","createElement","ref","className","classNames","CSSTransition","appear","nodeRef","unmount","remove","renderInstance","attach","Promise","resolve","render","instance","createPopupInstance","_ref3","_asyncToGenerator","_regeneratorRuntime","mark","_callee","popupProps","_popupProps$delay","_delay$","currentTriggerEl","delay","closeDelay","popupDom","mouseoutEvent","focusoutEvent","wrap","_callee$","_context","prev","next","getAttach","click","abrupt","document","body","appendChild","sent","setTimeout","off","on","focus","createPopper","popperOptions","stop","_x","_x2","_x3","apply","arguments","PopupPlugin"],"mappings":"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"}