{"version":3,"file":"linear-gradient.js","sources":["../../../../src/color-picker/components/panel/linear-gradient.tsx"],"sourcesContent":["import React, { KeyboardEvent, MouseEvent as ReactMouseEvent, useCallback, useEffect, useRef, useState } from 'react';\nimport cloneDeep from 'lodash/cloneDeep';\nimport classNames from 'classnames';\nimport useClassName from '../../hooks/useClassNames';\nimport { genGradientPoint, gradientColors2string } from '../../../_common/js/color-picker/color';\nimport { GradientColorPoint } from '../../../_common/js/color-picker/gradient';\nimport useCommonClassName from '../../../_util/useCommonClassName';\nimport { GRADIENT_SLIDER_DEFAULT_WIDTH } from '../../const';\nimport InputNumber from '../../../input-number';\n\nconst DELETE_KEYS: string[] = ['delete', 'backspace'];\n\ntype TSliderRect = {\n  left: number;\n  width: number;\n};\n\nconst LinearGradient = (props) => {\n  const { onChange, color, disabled } = props;\n  const baseClassName = useClassName();\n  const { STATUS: statusClassNames } = useCommonClassName();\n  const refSlider = useRef<HTMLDivElement>(null);\n  const sliderRectRef = useRef<TSliderRect>({\n    left: 0,\n    width: GRADIENT_SLIDER_DEFAULT_WIDTH,\n  });\n  const isDragging = useRef<Boolean>(false);\n  const isMoved = useRef<Boolean>(false);\n  const degree = useRef(props.color.gradientDegree);\n  const [selectedId, setSelectedId] = useState(props.color.gradientSelectedId);\n  const selectedRef = useRef(props.color.gradientSelectedId);\n  const colors = useRef<GradientColorPoint[]>(cloneDeep(color.gradientColors));\n\n  useEffect(() => {\n    degree.current = color?.gradientDegree;\n    setSelectedId(color.gradientSelectedId);\n    selectedRef.current = color.gradientSelectedId;\n    colors.current = cloneDeep(color.gradientColors);\n  }, [color.gradientColors, color?.gradientDegree, color.gradientSelectedId, color.value, color.saturation]);\n\n  const updateSliderRect = () => {\n    const rect = refSlider.current.getBoundingClientRect();\n    sliderRectRef.current = {\n      left: rect.left,\n      width: rect.width || GRADIENT_SLIDER_DEFAULT_WIDTH,\n    };\n  };\n\n  const handleChange = useCallback(\n    (key: 'degree' | 'selectedId' | 'colors', payload: any, addUsedColor?: boolean) => {\n      if (disabled) {\n        return;\n      }\n      onChange({\n        key,\n        payload,\n        addUsedColor,\n      });\n    },\n    [onChange, disabled],\n  );\n\n  const handleDegreeChange = (value: number) => {\n    if (props.disabled || value === props.color.gradientDegree) {\n      return;\n    }\n    degree.current = value;\n    handleChange('degree', value, true);\n  };\n\n  const handleSelectedIdChange = (value: string) => {\n    if (props.disabled) {\n      return;\n    }\n    setSelectedId(value);\n    selectedRef.current = value;\n    handleChange('selectedId', value);\n  };\n\n  const handleColorsChange = useCallback(\n    (value: GradientColorPoint[], isEnded?: boolean) => {\n      if (props.disabled) {\n        return;\n      }\n      colors.current = value;\n      handleChange('colors', value, isEnded);\n    },\n    [props.disabled, handleChange],\n  );\n\n  /**\n   * 设置bar的位置\n   * @param left\n   * @returns\n   */\n  const updateActiveThumbLeft = useCallback(\n    (left: number) => {\n      const index = colors.current.findIndex((c) => c.id === selectedRef.current);\n      if (index === -1) {\n        return;\n      }\n      const point = colors.current[index];\n      const formatLeft = Math.max(0, Math.min(sliderRectRef.current.width, left));\n\n      const percentLeft = (formatLeft / sliderRectRef.current.width) * 100;\n\n      const newColors = colors.current.map((item, i) =>\n        index !== i\n          ? item\n          : {\n              color: point.color,\n              left: percentLeft,\n              id: point.id,\n            },\n      );\n\n      handleColorsChange(newColors);\n    },\n    [handleColorsChange],\n  );\n\n  // 移动开始\n  const handleStart = (id: string, e: ReactMouseEvent) => {\n    if (isDragging.current || props.disabled) {\n      return;\n    }\n    selectedRef.current = id;\n    setSelectedId(id);\n    isMoved.current = false;\n    isDragging.current = true;\n    e.preventDefault();\n    e.stopPropagation();\n    // handleSelectedIdChange(id);\n    // 让 slider 获取焦点，以便键盘事件生效。\n    refSlider.current.focus();\n  };\n\n  // 移动中\n  const handleMove = useCallback(\n    (e: MouseEvent) => {\n      if (!isDragging.current || disabled) {\n        return;\n      }\n\n      const rect = refSlider.current.getBoundingClientRect();\n      const left = e.clientX - rect.x;\n      isMoved.current = true;\n      updateActiveThumbLeft(left);\n    },\n    [disabled, updateActiveThumbLeft],\n  );\n\n  // 移动结束\n  const handleEnd = useCallback(() => {\n    if (!isDragging.current) {\n      return;\n    }\n    setTimeout(() => {\n      isDragging.current = false;\n    }, 0);\n    if (isMoved.current) {\n      handleColorsChange(colors.current, true);\n      isMoved.current = false;\n    }\n  }, [handleColorsChange]);\n\n  const handleKeyup = (e: KeyboardEvent) => {\n    if (props.disabled) {\n      return;\n    }\n    const points = [...colors.current];\n    let pos = points.findIndex((c) => c.id === selectedRef.current);\n    const { length } = points;\n    // 必须保证有两个点\n    if (DELETE_KEYS.includes(e.key.toLocaleLowerCase()) && length > 2 && pos >= 0 && pos <= length - 1) {\n      points.splice(pos, 1);\n      if (!points[pos]) {\n        // eslint-disable-next-line no-nested-ternary\n        pos = points[pos + 1] ? pos + 1 : points[pos - 1] ? pos - 1 : 0;\n      }\n      const current = points[pos];\n      handleColorsChange(points, true);\n      handleSelectedIdChange(current?.id);\n    }\n  };\n\n  const handleThumbBarClick = (e: ReactMouseEvent) => {\n    if (props.disabled) {\n      return;\n    }\n    updateSliderRect();\n\n    let left = e.clientX - sliderRectRef.current.left;\n    left = Math.max(0, Math.min(sliderRectRef.current.width, left));\n    const percentLeft = (left / sliderRectRef.current.width) * 100;\n\n    const newPoint = genGradientPoint(percentLeft, props.color.rgba);\n    const newColors = [...colors.current];\n    newColors.push(newPoint);\n    handleColorsChange(newColors, true);\n    handleSelectedIdChange(newPoint.id);\n  };\n\n  useEffect(() => {\n    updateSliderRect();\n\n    window.addEventListener('mousemove', handleMove, false);\n    window.addEventListener('mouseup', handleEnd, false);\n    window.addEventListener('contextmenu', handleEnd, false);\n\n    return () => {\n      window.removeEventListener('mousemove', handleMove, false);\n      window.removeEventListener('mouseup', handleEnd, false);\n      window.removeEventListener('contextmenu', handleEnd, false);\n    };\n    // eslint-disable-next-line\n  }, []);\n\n  const { gradientColors } = props.color;\n\n  const thumbBackground = gradientColors2string({\n    points: gradientColors,\n    degree: 90,\n  });\n\n  const handleClickThumb = (e: ReactMouseEvent, t) => {\n    handleSelectedIdChange(t.id);\n    e.stopPropagation();\n  };\n\n  const allGradientColors = [...colors.current];\n  const { color: leftColor } = genGradientPoint(0, allGradientColors[0]?.color);\n  const { color: rightColor } = genGradientPoint(100, allGradientColors[allGradientColors.length - 1]?.color);\n\n  return (\n    <div className={`${baseClassName}__gradient`}>\n      <div\n        className={`${baseClassName}__gradient-slider`}\n        style={{\n          background: `linear-gradient(90deg, ${leftColor} 0%, ${leftColor} 50%, ${rightColor} 50%, ${rightColor} 100%)`,\n        }}\n      >\n        <div\n          className={classNames(`${baseClassName}__slider`, `${baseClassName}--bg-alpha`)}\n          onKeyUp={handleKeyup}\n          tabIndex={0}\n          ref={refSlider}\n        >\n          <ul\n            className=\"gradient-thumbs\"\n            onClick={handleThumbBarClick}\n            style={{\n              background: thumbBackground,\n            }}\n          >\n            {colors.current.map((t) => {\n              const left = `${Math.round(t.left * 100) / 100}%`;\n              return (\n                <li\n                  className={classNames([\n                    `${baseClassName}__thumb`,\n                    'gradient-thumbs__item',\n                    selectedId === t.id ? statusClassNames.active : '',\n                  ])}\n                  key={t.id}\n                  title={`${t.color} ${left}`}\n                  style={{\n                    color: t.color,\n                    left,\n                  }}\n                  onClick={(e) => handleClickThumb(e, t)}\n                  onMouseDown={(e: ReactMouseEvent) => handleStart(t.id, e)}\n                >\n                  <span className={classNames(['gradient-thumbs__item-inner', `${baseClassName}--bg-alpha`])}></span>\n                </li>\n              );\n            })}\n          </ul>\n        </div>\n      </div>\n      <div className={`${baseClassName}__gradient-degree`} title={`${degree}deg`}>\n        <InputNumber\n          theme=\"normal\"\n          min={0}\n          max={360}\n          step={1}\n          size=\"small\"\n          format={(value: number) => `${value}°`}\n          value={degree.current}\n          onBlur={handleDegreeChange}\n          onEnter={handleDegreeChange}\n          onChange={handleDegreeChange}\n          disabled={props.disabled}\n        />\n      </div>\n    </div>\n  );\n};\n\nexport default React.memo(LinearGradient);\n"],"names":["DELETE_KEYS","LinearGradient","props","_allGradientColors$","_allGradientColors","onChange","color","disabled","baseClassName","useClassName","_useCommonClassName","useCommonClassName","statusClassNames","STATUS","refSlider","useRef","sliderRectRef","left","width","GRADIENT_SLIDER_DEFAULT_WIDTH","isDragging","isMoved","degree","gradientDegree","_useState","useState","gradientSelectedId","_useState2","_slicedToArray","selectedId","setSelectedId","selectedRef","colors","cloneDeep","gradientColors","useEffect","current","value","saturation","updateSliderRect","rect","getBoundingClientRect","handleChange","useCallback","key","payload","addUsedColor","handleDegreeChange","handleSelectedIdChange","handleColorsChange","isEnded","updateActiveThumbLeft","index","findIndex","c","id","point","formatLeft","Math","max","min","percentLeft","newColors","map","item","i","handleStart","e","preventDefault","stopPropagation","focus","handleMove","clientX","x","handleEnd","setTimeout","handleKeyup","points","_toConsumableArray","pos","length","includes","toLocaleLowerCase","splice","handleThumbBarClick","newPoint","genGradientPoint","rgba","push","window","addEventListener","removeEventListener","thumbBackground","gradientColors2string","handleClickThumb","t","allGradientColors","_genGradientPoint","leftColor","_genGradientPoint2","rightColor","React","createElement","className","style","background","concat","classNames","onKeyUp","tabIndex","ref","onClick","round","active","title","onMouseDown","InputNumber","theme","step","size","format","onBlur","onEnter","memo"],"mappings":"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"}