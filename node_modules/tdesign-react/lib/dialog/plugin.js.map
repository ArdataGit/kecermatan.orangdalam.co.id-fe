{"version":3,"file":"plugin.js","sources":["../../src/dialog/plugin.tsx"],"sourcesContent":["import React from 'react';\nimport { render } from '../_util/react-render';\nimport DialogComponent, { DialogProps } from './Dialog';\n\nimport { getAttach } from '../_util/dom';\nimport { DialogOptions, DialogMethod, DialogConfirmMethod, DialogAlertMethod, DialogInstance } from './type';\nimport log from '../_common/js/log';\n\nexport interface DialogPluginType extends DialogMethod {\n  alert: DialogAlertMethod;\n  confirm: DialogConfirmMethod;\n}\n\nconst createDialog: DialogPluginType = (props: DialogOptions): DialogInstance => {\n  const dialogRef = React.createRef<DialogInstance>();\n  const options = { ...props };\n  const { visible = true } = options;\n\n  const fragment = document.createDocumentFragment();\n\n  render(<DialogComponent {...(options as DialogProps)} visible={visible} ref={dialogRef} isPlugin />, fragment);\n\n  const container = getAttach(options.attach);\n  if (container) {\n    container.appendChild(fragment);\n  } else {\n    log.error('Dialog', 'attach is not exist');\n  }\n\n  const dialogNode: DialogInstance = {\n    show: () => {\n      requestAnimationFrame(() => {\n        container.appendChild(fragment);\n        dialogRef.current?.show();\n      });\n    },\n    hide: () => {\n      requestAnimationFrame(() => {\n        dialogRef.current?.destroy();\n      });\n    },\n    setConfirmLoading: (loading: boolean) => {\n      requestAnimationFrame(() => {\n        dialogRef.current?.setConfirmLoading(loading);\n      });\n    },\n    update: (updateOptions: DialogOptions) => {\n      requestAnimationFrame(() => {\n        dialogRef.current?.update(updateOptions);\n      });\n    },\n    destroy: () => {\n      requestAnimationFrame(() => {\n        dialogRef.current?.destroy();\n      });\n    },\n  };\n  return dialogNode;\n};\n\nconst confirm: DialogConfirmMethod = (props: DialogOptions) => createDialog(props);\n\nconst alert: DialogAlertMethod = (props: Omit<DialogOptions, 'confirmBtn'>) => {\n  const options = { ...props };\n  options.cancelBtn = null;\n  return createDialog(options);\n};\n\ncreateDialog.alert = alert;\ncreateDialog.confirm = confirm;\n\nexport const DialogPlugin = createDialog;\n"],"names":["createDialog","props","dialogRef","React","createRef","options","_objectSpread","_options$visible","visible","fragment","document","createDocumentFragment","render","createElement","DialogComponent","ref","isPlugin","container","getAttach","attach","appendChild","log","error","dialogNode","show","requestAnimationFrame","_dialogRef$current","current","hide","_dialogRef$current2","destroy","setConfirmLoading","loading","_dialogRef$current3","update","updateOptions","_dialogRef$current4","_dialogRef$current5","confirm","alert","cancelBtn","DialogPlugin"],"mappings":"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"}