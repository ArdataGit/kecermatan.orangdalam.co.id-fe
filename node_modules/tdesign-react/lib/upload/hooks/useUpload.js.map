{"version":3,"file":"useUpload.js","sources":["../../../src/upload/hooks/useUpload.ts"],"sourcesContent":["import { useRef, useState, useMemo, ChangeEventHandler, MouseEvent, useEffect, ClipboardEventHandler } from 'react';\nimport merge from 'lodash/merge';\nimport { SizeLimitObj, TdUploadProps, UploadChangeContext, UploadFile, UploadRemoveContext } from '../type';\nimport {\n  getFilesAndErrors,\n  validateFile,\n  upload,\n  getTriggerTextField,\n  getDisplayFiles,\n  formatToUploadFile,\n} from '../../_common/js/upload/main';\nimport { getFileList } from '../../_common/js/upload/utils';\nimport useControlled from '../../hooks/useControlled';\nimport { InnerProgressContext, OnResponseErrorContext, SuccessContext } from '../../_common/js/upload/types';\nimport useConfig from '../../hooks/useConfig';\nimport { useLocaleReceiver } from '../../locale/LocalReceiver';\n\n/**\n * 上传组件全部逻辑，方便脱离 UI，自定义 UI 组件\n */\nexport default function useUpload(props: TdUploadProps) {\n  const inputRef = useRef<HTMLInputElement>();\n  // TODO: Form 表单控制上传组件是否禁用\n  const { disabled, autoUpload, isBatchUpload } = props;\n  const { classPrefix } = useConfig();\n  const [globalLocale, t] = useLocaleReceiver('upload');\n  const [uploadValue, setUploadValue] = useControlled(props, 'files', props.onChange);\n  const xhrReq = useRef<{ files: UploadFile[]; xhrReq: XMLHttpRequest }[]>([]);\n  const [toUploadFiles, setToUploadFiles] = useState<UploadFile[]>([]);\n  const [sizeOverLimitMessage, setSizeOverLimitMessage] = useState('');\n  const [update, forceUpdate] = useState({});\n\n  const locale = useMemo(() => merge({}, globalLocale, props.locale), [globalLocale, props.locale]);\n\n  const tipsClasses = `${classPrefix}-upload__tips ${classPrefix}-size-s`;\n  const errorClasses = [tipsClasses].concat(`${classPrefix}-upload__tips-error`);\n  const placeholderClass = `${classPrefix}-upload__placeholder`;\n\n  // 单文件场景：触发元素文本\n  const triggerUploadText = useMemo(() => {\n    const field = getTriggerTextField({\n      isBatchUpload,\n      multiple: props.multiple,\n      status: uploadValue?.[0]?.status,\n      autoUpload,\n    });\n    return locale.triggerUploadText[field];\n  }, [locale.triggerUploadText, uploadValue, props.multiple, isBatchUpload, autoUpload]);\n\n  const [uploading, setUploading] = useState(false);\n\n  // 文件列表显示的内容（自动上传和非自动上传有所不同）\n  const [displayFiles, setDisplayFiles] = useState(uploadValue || []);\n  useEffect(() => {\n    const files = getDisplayFiles({\n      multiple: props.multiple,\n      toUploadFiles,\n      uploadValue: uploadValue ? [...uploadValue] : [],\n      autoUpload,\n      isBatchUpload,\n    });\n    setDisplayFiles(files);\n  }, [props.multiple, toUploadFiles, uploadValue, autoUpload, isBatchUpload, update]);\n\n  const uploadFilePercent = (params: { file: UploadFile; percent: number }) => {\n    const { file, percent } = params;\n    if (autoUpload) {\n      const index = toUploadFiles.findIndex((item) => file.raw === item.raw);\n      const newFiles = [...toUploadFiles];\n      newFiles[index] = { ...newFiles[index], percent };\n      setToUploadFiles(newFiles);\n    } else {\n      const index = uploadValue.findIndex((item) => file.raw === item.raw);\n      uploadValue[index] = { ...uploadValue[index], percent };\n      /**\n       * 使用强制更新，修复手动自定义上传的percent无效\n       * https://github.com/Tencent/tdesign-react/issues/2893\n       */\n      forceUpdate({});\n    }\n  };\n\n  const updateProgress = (\n    p: InnerProgressContext | SuccessContext | OnResponseErrorContext,\n    toFiles: UploadFile[],\n    trigger: 'progress' | 'progress-success' | 'progress-fail',\n  ) => {\n    if (props.autoUpload) {\n      setToUploadFiles([...toFiles]);\n    } else {\n      setUploadValue([...uploadValue], {\n        e: p.event,\n        trigger,\n        index: uploadValue.length,\n        file: p.files[0],\n      });\n    }\n  };\n\n  const onResponseError = (p: OnResponseErrorContext, toFiles?: UploadFile[]) => {\n    if (!p || !p.files || !p.files[0]) return;\n    if (toFiles) {\n      updateProgress(p, toFiles, 'progress-fail');\n    }\n    const { response, event, files } = p;\n    props.onOneFileFail?.({\n      e: event,\n      file: files?.[0],\n      currentFiles: files,\n      failedFiles: files,\n      response,\n    });\n  };\n\n  const onResponseProgress = (p: InnerProgressContext, toFiles: UploadFile[]) => {\n    updateProgress(p, toFiles, 'progress');\n    props.onProgress?.({\n      e: p.event,\n      file: p.file,\n      currentFiles: p.files,\n      percent: p.percent,\n      type: p.type,\n      XMLHttpRequest: p.XMLHttpRequest,\n    });\n  };\n\n  // 只有多个上传请求同时触发时才需 onOneFileSuccess\n  const onResponseSuccess = (p: SuccessContext, toFiles: UploadFile[]) => {\n    if (props.multiple && !props.uploadAllFilesInOneRequest) {\n      updateProgress(p, toFiles, 'progress-success');\n      props.onOneFileSuccess?.({\n        e: p.event,\n        file: p.files[0],\n        response: p.response,\n      });\n    }\n  };\n\n  function getSizeLimitError(sizeLimitObj: SizeLimitObj) {\n    const limit = sizeLimitObj;\n    return limit.message\n      ? t(limit.message, { sizeLimit: limit.size })\n      : `${t(locale.sizeLimitMessage, { sizeLimit: limit.size })} ${limit.unit}`;\n  }\n\n  const handleNotAutoUpload = (toFiles: UploadFile[]) => {\n    const tmpFiles = props.multiple && !isBatchUpload ? uploadValue.concat(toFiles) : toFiles;\n    if (!tmpFiles.length) return;\n    setUploadValue(tmpFiles, {\n      trigger: 'add',\n      index: uploadValue.length,\n      file: toFiles[0],\n      files: toFiles,\n    });\n    setToUploadFiles([]);\n  };\n\n  const onFileChange = (files: File[]) => {\n    if (disabled) return;\n    // @ts-ignore\n    props.onSelectChange?.([...files], { currentSelectedFiles: formatToUploadFile([...files], props.format) });\n    validateFile({\n      uploadValue,\n      // @ts-ignore\n      files: [...files],\n      allowUploadDuplicateFile: props.allowUploadDuplicateFile,\n      max: props.multiple ? props.max : 0,\n      sizeLimit: props.sizeLimit,\n      isBatchUpload,\n      autoUpload,\n      format: props.format,\n      beforeUpload: props.beforeUpload,\n      beforeAllFilesUpload: props.beforeAllFilesUpload,\n    }).then((args) => {\n      // 自定义全文件校验不通过\n      if (args.validateResult?.type === 'BEFORE_ALL_FILES_UPLOAD') {\n        props.onValidate?.({ type: 'BEFORE_ALL_FILES_UPLOAD', files: args.files });\n        return;\n      }\n      // 文件数量校验不通过\n      if (args.lengthOverLimit) {\n        props.onValidate?.({ type: 'FILES_OVER_LENGTH_LIMIT', files: args.files });\n        if (!args.files.length) return;\n      }\n      // 过滤相同的文件名\n      if (args.hasSameNameFile) {\n        props.onValidate?.({ type: 'FILTER_FILE_SAME_NAME', files: args.files });\n      }\n      // 文件大小校验结果处理（已过滤超出限制的文件）\n      if (args.fileValidateList instanceof Array) {\n        const { sizeLimitErrors, beforeUploadErrorFiles, toFiles } = getFilesAndErrors(\n          args.fileValidateList,\n          getSizeLimitError,\n        );\n        const tmpWaitingFiles = autoUpload ? toFiles : toUploadFiles.concat(toFiles);\n        props.onWaitingUploadFilesChange?.({ files: tmpWaitingFiles, trigger: 'validate' });\n        // 文件大小处理\n        if (sizeLimitErrors[0]) {\n          setSizeOverLimitMessage(sizeLimitErrors[0].file.response.error);\n          props.onValidate?.({ type: 'FILE_OVER_SIZE_LIMIT', files: sizeLimitErrors.map((t) => t.file) });\n        } else {\n          setSizeOverLimitMessage('');\n          // 自定义方法 beforeUpload 拦截的文件\n          if (beforeUploadErrorFiles.length) {\n            props.onValidate?.({ type: 'CUSTOM_BEFORE_UPLOAD', files: beforeUploadErrorFiles });\n          }\n        }\n        // 如果是自动上传\n        if (autoUpload) {\n          setToUploadFiles(tmpWaitingFiles);\n          uploadFiles(tmpWaitingFiles);\n        } else {\n          handleNotAutoUpload(tmpWaitingFiles);\n        }\n      }\n    });\n\n    // 清空 <input type=\"file\"> 元素的文件，避免出现重复文件无法选择的情况\n    inputRef.current.value = null;\n  };\n\n  const onNormalFileChange: ChangeEventHandler<HTMLInputElement> = (e) => {\n    const fileList = getFileList(e.target.files);\n    onFileChange?.(fileList);\n  };\n\n  function onDragFileChange(files: File[]) {\n    onFileChange?.(files);\n  }\n\n  const onPasteFileChange: ClipboardEventHandler<HTMLDivElement> = (e) => {\n    // @ts-ignore\n    onFileChange?.([...e.clipboardData.files]);\n  };\n\n  /**\n   * 上传文件。对外暴露方法，修改时需谨慎\n   * @param toFiles 本地上传的文件列表\n   */\n  function uploadFiles(toFiles?: UploadFile[]) {\n    const notUploadedFiles = uploadValue.filter((t) => t.status !== 'success');\n    const files = autoUpload ? toFiles : notUploadedFiles;\n    if (!files || !files.length) return;\n    xhrReq.current = [];\n    setUploading(true);\n    upload({\n      action: props.action,\n      method: props.method,\n      headers: props.headers,\n      name: props.name,\n      withCredentials: props.withCredentials,\n      uploadedFiles: uploadValue,\n      toUploadFiles: files,\n      multiple: props.multiple,\n      isBatchUpload,\n      autoUpload,\n      uploadAllFilesInOneRequest: props.uploadAllFilesInOneRequest,\n      useMockProgress: props.useMockProgress,\n      data: props.data,\n      mockProgressDuration: props.mockProgressDuration,\n      requestMethod: props.requestMethod,\n      formatRequest: props.formatRequest,\n      formatResponse: props.formatResponse,\n      onResponseProgress: (p) => onResponseProgress(p, toFiles),\n      onResponseSuccess: (p) => onResponseSuccess(p, toFiles),\n      onResponseError: (p) => onResponseError(p, toFiles),\n      setXhrObject: (xhr) => {\n        if (xhr.files[0]?.raw && xhrReq.current.find((item) => item.files[0].raw === xhr.files[0].raw)) return;\n        xhrReq.current = xhrReq.current.concat(xhr);\n      },\n    }).then(({ status, data, list, failedFiles }) => {\n      setUploading(false);\n      if (status === 'success') {\n        // 全部上传成功后，一次性添加（非自动上传已在上一步添加）\n        if (props.autoUpload) {\n          setUploadValue([...data.files], {\n            trigger: 'add',\n            file: data.files[0],\n          });\n        }\n        props.onSuccess?.({\n          fileList: data.files,\n          currentFiles: files,\n          file: files[0],\n          // 只有全部请求完成后，才会存在该字段\n          results: list?.map((t) => t.data),\n          // 单文件单请求有一个 response，多文件多请求有多个 response\n          response: data.response || list.map((t) => t.data.response),\n          XMLHttpRequest: data.XMLHttpRequest,\n        });\n        xhrReq.current = [];\n      } else if (failedFiles?.[0]) {\n        props.onFail?.({\n          e: data.event,\n          file: failedFiles[0],\n          failedFiles,\n          currentFiles: files,\n          response: data.response,\n          XMLHttpRequest: data.XMLHttpRequest,\n        });\n      }\n\n      // 非自动上传，文件都在 uploadValue，不涉及 toUploadFiles\n      if (autoUpload) {\n        setToUploadFiles(failedFiles);\n        props.onWaitingUploadFilesChange?.({ files: failedFiles, trigger: 'uploaded' });\n      }\n    });\n  }\n\n  function onRemove(p: UploadRemoveContext) {\n    setSizeOverLimitMessage('');\n    const changePrams: UploadChangeContext = {\n      e: p.e,\n      trigger: 'remove',\n      index: p.index,\n      file: p.file,\n    };\n    // remove all files for batchUpload\n    if (isBatchUpload || !props.multiple) {\n      props.onWaitingUploadFilesChange?.({ files: [], trigger: 'remove' });\n      setUploadValue([], changePrams);\n      setToUploadFiles([]);\n      xhrReq.current = [];\n    } else if (!props.autoUpload) {\n      uploadValue.splice(p.index, 1);\n      setUploadValue([...uploadValue], changePrams);\n    } else if (p.index < uploadValue.length) {\n      // autoUpload 场景下， p.index < uploadValue.length 表示移除已经上传成功的文件；反之表示移除待上传列表文件\n      uploadValue.splice(p.index, 1);\n      setUploadValue([...uploadValue], changePrams);\n    } else {\n      const tmpFiles = [...toUploadFiles];\n      tmpFiles.splice(p.index - uploadValue.length, 1);\n      // toUploadFiles.current = [...tmpFiles];\n      setToUploadFiles([...tmpFiles]);\n      props.onWaitingUploadFilesChange?.({ files: [...tmpFiles], trigger: 'remove' });\n    }\n    props.onRemove?.(p);\n  }\n\n  const triggerUpload = () => {\n    if (disabled || !inputRef.current) return;\n    (inputRef.current as HTMLInputElement).click();\n  };\n\n  const cancelUpload = (context?: { file?: UploadFile; e?: MouseEvent<HTMLElement> }) => {\n    xhrReq.current?.forEach((item) => {\n      item.xhrReq?.abort();\n    });\n    setUploading(false);\n\n    // autoUpload do not need to reset to waiting state\n    if (autoUpload) {\n      setToUploadFiles([]);\n    } else {\n      setUploadValue(\n        uploadValue.map((item) => {\n          if (item.status !== 'success') {\n            return { ...item, status: 'waiting' };\n          }\n          return item;\n        }),\n        { trigger: 'abort' },\n      );\n    }\n\n    if (context?.file && !autoUpload) {\n      onRemove?.({ file: context.file, e: context.e, index: 0 });\n    }\n\n    props.onCancelUpload?.();\n  };\n\n  // 矫正数据格式为数组\n  useEffect(() => {\n    if (!Array.isArray(uploadValue)) {\n      setUploadValue([], { trigger: 'default' });\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [uploadValue]);\n\n  return {\n    t,\n    locale,\n    classPrefix,\n    triggerUploadText,\n    toUploadFiles,\n    uploadValue,\n    displayFiles,\n    sizeOverLimitMessage,\n    uploading,\n    tipsClasses,\n    errorClasses,\n    placeholderClass,\n    inputRef,\n    disabled,\n    xhrReq,\n    uploadFilePercent,\n    uploadFiles,\n    onFileChange,\n    onNormalFileChange,\n    onDragFileChange,\n    onPasteFileChange,\n    onRemove,\n    triggerUpload,\n    cancelUpload,\n  };\n}\n"],"names":["useUpload","props","inputRef","useRef","disabled","autoUpload","isBatchUpload","_useConfig","useConfig","classPrefix","_useLocaleReceiver","useLocaleReceiver","_useLocaleReceiver2","_slicedToArray","globalLocale","t","_useControlled","useControlled","onChange","_useControlled2","uploadValue","setUploadValue","xhrReq","_useState","useState","_useState2","toUploadFiles","setToUploadFiles","_useState3","_useState4","sizeOverLimitMessage","setSizeOverLimitMessage","_useState5","_useState6","update","forceUpdate","locale","useMemo","merge","tipsClasses","concat","errorClasses","placeholderClass","triggerUploadText","_uploadValue$","field","getTriggerTextField","multiple","status","_useState7","_useState8","uploading","setUploading","_useState9","_useState10","displayFiles","setDisplayFiles","useEffect","files","getDisplayFiles","_toConsumableArray","uploadFilePercent","params","file","percent","index","findIndex","item","raw","newFiles","_objectSpread","updateProgress","p","toFiles","trigger","e","event","length","onResponseError","_props$onOneFileFail","response","onOneFileFail","call","currentFiles","failedFiles","onResponseProgress","_props$onProgress","onProgress","type","XMLHttpRequest","onResponseSuccess","uploadAllFilesInOneRequest","_props$onOneFileSucce","onOneFileSuccess","getSizeLimitError","sizeLimitObj","limit","message","sizeLimit","size","sizeLimitMessage","unit","handleNotAutoUpload","tmpFiles","onFileChange","_props$onSelectChange","onSelectChange","currentSelectedFiles","formatToUploadFile","format","validateFile","allowUploadDuplicateFile","max","beforeUpload","beforeAllFilesUpload","then","args","_args$validateResult","validateResult","_props$onValidate","onValidate","lengthOverLimit","_props$onValidate2","hasSameNameFile","_props$onValidate3","fileValidateList","Array","_props$onWaitingUploa","_getFilesAndErrors","getFilesAndErrors","sizeLimitErrors","beforeUploadErrorFiles","tmpWaitingFiles","onWaitingUploadFilesChange","_props$onValidate4","error","map","_props$onValidate5","uploadFiles","current","value","onNormalFileChange","fileList","getFileList","target","onDragFileChange","onPasteFileChange","clipboardData","notUploadedFiles","filter","upload","action","method","headers","name","withCredentials","uploadedFiles","useMockProgress","data","mockProgressDuration","requestMethod","formatRequest","formatResponse","setXhrObject","xhr","_xhr$files$","find","_ref","list","_props$onSuccess","onSuccess","results","_props$onFail","onFail","_props$onWaitingUploa2","onRemove","_props$onRemove","changePrams","_props$onWaitingUploa3","splice","_props$onWaitingUploa4","triggerUpload","click","cancelUpload","context","_xhrReq$current","_props$onCancelUpload","forEach","_item$xhrReq","abort","onCancelUpload","isArray"],"mappings":"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"}