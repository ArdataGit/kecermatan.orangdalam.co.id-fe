{"version":3,"file":"dep-be56e61e.js","sources":["../../src/radio/RadioGroup.tsx","../../src/radio/Radio.tsx"],"sourcesContent":["import React, { ReactNode, useState, useEffect, useRef } from 'react';\nimport classNames from 'classnames';\nimport useConfig from '../hooks/useConfig';\nimport { TdRadioGroupProps } from './type';\nimport useControlled from '../hooks/useControlled';\nimport useCommonClassName from '../_util/useCommonClassName';\nimport { StyledProps } from '../common';\nimport { CheckContext, CheckContextValue } from '../common/Check';\nimport Radio from './Radio';\nimport useMutationObservable from '../_util/useMutationObserver';\nimport { radioGroupDefaultProps } from './defaultProps';\nimport useDefaultProps from '../hooks/useDefaultProps';\nimport useKeyboard from './useKeyboard';\n\n/**\n * RadioGroup 组件所接收的属性\n */\nexport interface RadioGroupProps extends TdRadioGroupProps, StyledProps {\n  children?: ReactNode;\n}\n\n/**\n * 单选选项组，里面可以嵌套 <Radio />\n */\nconst RadioGroup: React.FC<RadioGroupProps> = (originalProps) => {\n  const { classPrefix } = useConfig();\n\n  const props = useDefaultProps<RadioGroupProps>(originalProps, radioGroupDefaultProps);\n\n  const { disabled, children, onChange, size, variant, options = [], className, style } = props;\n\n  const [internalValue, setInternalValue] = useControlled(props, 'value', onChange);\n  const [barStyle, setBarStyle] = useState({});\n  const radioGroupRef = useRef<HTMLDivElement>(null);\n\n  useKeyboard(radioGroupRef, setInternalValue);\n\n  const checkedRadioCls = `.${classPrefix}-radio-button.${classPrefix}-is-checked`;\n  const { SIZE: sizeMap } = useCommonClassName();\n\n  const context: CheckContextValue = {\n    inject: (checkProps) => {\n      // 如果已经受控，则不注入\n      if (typeof checkProps.checked !== 'undefined') {\n        return checkProps;\n      }\n\n      const { value: checkValue } = checkProps;\n\n      return {\n        ...checkProps,\n        name: props.name,\n        // 有一个允许取消，就可以取消选中\n        allowUncheck: checkProps.allowUncheck || props.allowUncheck,\n        checked: internalValue === checkProps.value,\n        disabled: checkProps.disabled || disabled,\n        onChange(checked, { e }) {\n          if (typeof checkProps.onChange === 'function') {\n            checkProps.onChange(checked, { e });\n          }\n          setInternalValue(checked ? checkValue : undefined, { e });\n        },\n      };\n    },\n  };\n\n  const calcBarStyle = () => {\n    if (!variant.includes('filled')) {\n      return;\n    }\n    const checkedRadio = radioGroupRef.current.querySelector?.(checkedRadioCls) as HTMLElement;\n    if (!checkedRadio) {\n      return setBarStyle({ width: 0 });\n    }\n\n    const { offsetWidth, offsetHeight, offsetLeft, offsetTop } = checkedRadio;\n    setBarStyle({\n      width: `${offsetWidth}px`,\n      height: `${offsetHeight}px`,\n      left: `${offsetLeft}px`,\n      top: `${offsetTop}px`,\n    });\n  };\n\n  useEffect(() => {\n    calcBarStyle();\n  }, [radioGroupRef.current, internalValue]); // eslint-disable-line react-hooks/exhaustive-deps\n\n  useMutationObservable(radioGroupRef.current, calcBarStyle);\n\n  const renderBlock = () => {\n    if (!variant.includes('filled')) {\n      return null;\n    }\n    return <div style={barStyle} className={`${classPrefix}-radio-group__bg-block`}></div>;\n  };\n\n  const renderOptions = () => {\n    const Comp = variant.includes('filled') ? Radio.Button : Radio;\n    return options.map((item) => {\n      let label: ReactNode;\n      let value: string | number;\n      let disabled: boolean | undefined;\n      if (typeof item === 'string' || typeof item === 'number') {\n        label = item;\n        value = item;\n      } else {\n        label = item.label;\n        value = item.value;\n        disabled = item.disabled;\n      }\n      return (\n        <Comp value={value} key={value} disabled={disabled}>\n          {label}\n        </Comp>\n      );\n    });\n  };\n\n  return (\n    <CheckContext.Provider value={context}>\n      <div\n        ref={radioGroupRef}\n        style={style}\n        className={classNames(`${classPrefix}-radio-group`, sizeMap[size], className, {\n          [`${classPrefix}-radio-group__outline`]: variant === 'outline',\n          [`${classPrefix}-radio-group--filled`]: variant.includes('filled'),\n          [`${classPrefix}-radio-group--primary-filled`]: variant === 'primary-filled',\n        })}\n      >\n        {children || renderOptions()}\n        {renderBlock()}\n      </div>\n    </CheckContext.Provider>\n  );\n};\n\nRadioGroup.displayName = 'RadioGroup';\n\nexport default RadioGroup;\n","import React, { Ref, forwardRef } from 'react';\nimport forwardRefWithStatics from '../_util/forwardRefWithStatics';\nimport Check, { CheckProps } from '../common/Check';\nimport RadioGroup from './RadioGroup';\nimport { radioDefaultProps } from './defaultProps';\nimport useDefaultProps from '../hooks/useDefaultProps';\n\nexport type RadioProps = Omit<CheckProps, 'type'>;\n\nconst Radio = forwardRefWithStatics(\n  (props: RadioProps, ref: Ref<HTMLLabelElement>) => (\n    <Check ref={ref} type=\"radio\" {...useDefaultProps<RadioProps>(props, radioDefaultProps)} />\n  ),\n  {\n    Group: RadioGroup,\n    Button: forwardRef<HTMLLabelElement, RadioProps>((props, ref) => (\n      <Check ref={ref} type=\"radio-button\" {...useDefaultProps<RadioProps>(props, radioDefaultProps)} />\n    )),\n  },\n);\n\nRadio.displayName = 'Radio';\n\nexport default Radio;\n"],"names":["RadioGroup","originalProps","_useConfig","useConfig","classPrefix","props","useDefaultProps","radioGroupDefaultProps","disabled","children","onChange","size","variant","_props$options","options","className","style","_useControlled","useControlled","_useControlled2","_slicedToArray","internalValue","setInternalValue","_useState","useState","_useState2","barStyle","setBarStyle","radioGroupRef","useRef","useKeyboard","checkedRadioCls","concat","_useCommonClassName","useCommonClassName","sizeMap","SIZE","context","inject","checkProps","checked","checkValue","value","_objectSpread","name","allowUncheck","_ref","e","calcBarStyle","_radioGroupRef$curren","_radioGroupRef$curren2","includes","checkedRadio","current","querySelector","call","width","offsetWidth","offsetHeight","offsetLeft","offsetTop","height","left","top","useEffect","useMutationObservable","renderBlock","React","createElement","renderOptions","Comp","Radio","Button","map","item","label","key","CheckContext","Provider","ref","classNames","_defineProperty","displayName","forwardRefWithStatics","Check","type","radioDefaultProps","Group","forwardRef"],"mappings":";;;;;;;;;;;;;;;;;;;;;;AAwBA,IAAMA,UAAA,GAAwC,SAAxCA,UAAAA,CAAyCC,aAAkB,EAAA;AACzD,EAAA,IAAAC,UAAA,GAAkBC,SAAU,EAAA;IAA1BC,WAAY,GAAAF,UAAA,CAAZE,WAAY,CAAA;AAEd,EAAA,IAAAC,KAAA,GAAQC,eAAiC,CAAAL,aAAA,EAAeM,sBAAsB,CAAA,CAAA;AAE9E,EAAA,IAAEC,QAAU,GAAsEH,KAAA,CAAhFG,QAAU;IAAAC,QAAA,GAAsEJ,KAAA,CAAtEI,QAAA;IAAUC,QAAU,GAAkDL,KAAA,CAA5DK,QAAU;IAAAC,IAAA,GAAkDN,KAAA,CAAlDM,IAAA;IAAMC,OAAS,GAAmCP,KAAA,CAA5CO,OAAS;IAAAC,cAAA,GAAmCR,KAAA,CAAnCS,OAAA;AAAAA,IAAAA,OAAA,GAAAD,cAAA,KAAU,KAAA,CAAA,GAAA,EAAC,GAAAA,cAAA;IAAGE,SAAW,GAAUV,KAAA,CAArBU,SAAW;IAAAC,KAAA,GAAUX,KAAA,CAAVW,KAAA,CAAA;EAE9E,IAAAC,cAAA,GAA0CC,aAAc,CAAAb,KAAA,EAAO,SAASK,QAAQ,CAAA;IAAAS,eAAA,GAAAC,cAAA,CAAAH,cAAA,EAAA,CAAA,CAAA;AAAzEI,IAAAA,aAAe,GAAAF,eAAA,CAAA,CAAA,CAAA;AAAAG,IAAAA,gBAAgB,GAAAH,eAAA,CAAA,CAAA,CAAA,CAAA;AACtC,EAAA,IAAAI,SAAA,GAAgCC,QAAA,CAAS,EAAE,CAAA;IAAAC,UAAA,GAAAL,cAAA,CAAAG,SAAA,EAAA,CAAA,CAAA;AAApCG,IAAAA,QAAU,GAAAD,UAAA,CAAA,CAAA,CAAA;AAAAE,IAAAA,WAAW,GAAAF,UAAA,CAAA,CAAA,CAAA,CAAA;AACtB,EAAA,IAAAG,aAAA,GAAgBC,OAAuB,IAAI,CAAA,CAAA;AAEjDC,EAAAA,WAAA,CAAYF,eAAeN,gBAAgB,CAAA,CAAA;EAErC,IAAAS,eAAA,OAAAC,MAAA,CAAsB5B,WAA4B,EAAA4B,gBAAAA,CAAAA,CAAAA,MAAA,CAAA5B,WAAA,EAAA,aAAA,CAAA,CAAA;AACxD,EAAA,IAAA6B,mBAAA,GAA0BC,kBAAmB,EAAA;IAA/BC,OAAQ,GAAAF,mBAAA,CAAdG,IAAA,CAAA;AAER,EAAA,IAAMC,OAA6B,GAAA;AACjCC,IAAAA,MAAA,EAAQ,SAAAA,MAACC,CAAAA,UAAe,EAAA;AAElB,MAAA,IAAA,OAAOA,UAAW,CAAAC,OAAA,KAAY,WAAa,EAAA;AACtC,QAAA,OAAAD,UAAA,CAAA;AACT,OAAA;AAEM,MAAA,IAASE,UAAA,GAAeF,UAAA,CAAtBG,KAAO,CAAA;AAER,MAAA,OAAAC,eAAA,CAAAA,eAAA,CAAA,EAAA,EACFJ,UAAA,CAAA,EAAA,EAAA,EAAA;QACHK,MAAMvC,KAAM,CAAAuC,IAAA;AAEZC,QAAAA,YAAA,EAAcN,UAAW,CAAAM,YAAA,IAAgBxC,KAAM,CAAAwC,YAAA;AAC/CL,QAAAA,OAAA,EAASnB,kBAAkBkB,UAAW,CAAAG,KAAA;AACtClC,QAAAA,QAAA,EAAU+B,WAAW/B,QAAY,IAAAA,QAAA;AACjCE,QAAAA,QAAS,EAAAA,SAAAA,QAAAA,CAAA8B,OAAA,EAAAM,IAAA,EAAgB;AAAA,UAAA,IAALC,CAAA,GAAAD,IAAA,CAAAC,CAAA,CAAA;AACd,UAAA,IAAA,OAAOR,UAAW,CAAA7B,QAAA,KAAa,UAAY,EAAA;AAC7C6B,YAAAA,UAAA,CAAW7B,QAAS,CAAA8B,OAAA,EAAS;AAAEO,cAAAA,CAAA,EAAAA,CAAAA;AAAE,aAAC,CAAA,CAAA;AACpC,WAAA;AACAzB,UAAAA,gBAAA,CAAiBkB,OAAU,GAAAC,UAAA,GAAa,KAAW,CAAA,EAAA;AAAEM,YAAAA,GAAAA,CAAAA;AAAE,WAAC,CAAA,CAAA;AAC1D,SAAA;AAAA,OAAA,CAAA,CAAA;AAEJ,KAAA;GACF,CAAA;AAEA,EAAA,IAAMC,eAAe,SAAfA,eAAqB;IAAA,IAAAC,qBAAA,EAAAC,sBAAA,CAAA;AACzB,IAAA,IAAI,CAACtC,OAAA,CAAQuC,QAAS,CAAA,QAAQ,CAAG,EAAA;AAC/B,MAAA,OAAA;AACF,KAAA;IACA,IAAMC,YAAe,IAAAH,qBAAA,GAAA,CAAAC,sBAAA,GAAAtB,aAAA,CAAcyB,OAAQ,EAAAC,aAAA,MAAAL,IAAAA,IAAAA,qBAAA,uBAAtBA,qBAAA,CAAAM,IAAA,CAAAL,sBAAA,EAAsCnB,eAAe,CAAA,CAAA;IAC1E,IAAI,CAACqB,YAAc,EAAA;AACjB,MAAA,OAAOzB,WAAY,CAAA;AAAE6B,QAAAA,KAAO,EAAA,CAAA;AAAE,OAAC,CAAA,CAAA;AACjC,KAAA;AAEA,IAAA,IAAQC,WAAA,GAAqDL,YAAA,CAArDK,WAAA;MAAaC,YAAc,GAA0BN,YAAA,CAAxCM,YAAc;MAAAC,UAAA,GAA0BP,YAAA,CAA1BO,UAAA;MAAYC,YAAcR,YAAA,CAAdQ;AACnCjC,IAAAA,WAAA,CAAA;AACV6B,MAAAA,iBAAUC,WAAA,EAAA,IAAA,CAAA;AACVI,MAAAA,kBAAWH,YAAA,EAAA,IAAA,CAAA;AACXI,MAAAA,gBAASH,UAAA,EAAA,IAAA,CAAA;MACTI,eAAQH,SAAA,EAAA,IAAA,CAAA;AACV,KAAC,CAAA,CAAA;GACH,CAAA;AAEAI,EAAAA,SAAA,CAAU,YAAM;AACDhB,IAAAA,YAAA,EAAA,CAAA;GACZ,EAAA,CAACpB,aAAc,CAAAyB,OAAA,EAAShC,aAAa,CAAC,CAAA,CAAA;AAEnB4C,EAAAA,qBAAA,CAAArC,aAAA,CAAcyB,SAASL,YAAY,CAAA,CAAA;AAEzD,EAAA,IAAMkB,cAAc,SAAdA,cAAoB;AACxB,IAAA,IAAI,CAACtD,OAAA,CAAQuC,QAAS,CAAA,QAAQ,CAAG,EAAA;AACxB,MAAA,OAAA,IAAA,CAAA;AACT,KAAA;AACA,IAAA,sBAAQgB,KAAA,CAAAC,aAAA,CAAA,KAAA,EAAA;AAAIpD,MAAAA,KAAO,EAAAU,QAAA;MAAUX,qBAAcX,WAAA,EAAA,wBAAA,CAAA;AAAqC,KAAA,CAAA,CAAA;GAClF,CAAA;AAEA,EAAA,IAAMiE,gBAAgB,SAAhBA,gBAAsB;AAC1B,IAAA,IAAMC,OAAO1D,OAAQ,CAAAuC,QAAA,CAAS,QAAQ,CAAA,GAAIoB,MAAMC,MAAS,GAAAD,KAAA,CAAA;AAClD,IAAA,OAAAzD,OAAA,CAAQ2D,GAAI,CAAA,UAACC,IAAS,EAAA;AACvB,MAAA,IAAAC,KAAA,CAAA;AACA,MAAA,IAAAjC,KAAA,CAAA;AACAlC,MAAAA,IAAAA,SAAAA,CAAAA;MACJ,IAAI,OAAOkE,IAAA,KAAS,QAAY,IAAA,OAAOA,SAAS,QAAU,EAAA;AAChDC,QAAAA,KAAA,GAAAD,IAAA,CAAA;AACAhC,QAAAA,KAAA,GAAAgC,IAAA,CAAA;AACV,OAAO,MAAA;QACLC,KAAA,GAAQD,IAAK,CAAAC,KAAA,CAAA;QACbjC,KAAA,GAAQgC,IAAK,CAAAhC,KAAA,CAAA;QACblC,YAAWkE,IAAK,CAAAlE,QAAA,CAAA;AAClB,OAAA;AACA,MAAA,sBACG2D,KAAA,CAAAC,aAAA,CAAAE,IAAA,EAAA;AAAK5B,QAAAA,KAAA,EAAAA,KAAA;AAAckC,QAAAA,GAAK,EAAAlC,KAAA;AAAOlC,QAAAA,QAAUA,EAAAA,SAAAA;OAAA,EACvCmE,KACH,CAAA,CAAA;AAEJ,KAAC,CAAA,CAAA;GACH,CAAA;EAGE,sBAAAR,KAAA,CAAAC,aAAA,CAACS,aAAaC,QAAb,EAAA;AAAsBpC,IAAAA,KAAO,EAAAL,OAAAA;AAAA,GAAA,iBAC3B8B,KAAA,CAAAC,aAAA,CAAA,KAAA,EAAA;AACCW,IAAAA,GAAK,EAAAnD,aAAA;AACLZ,IAAAA,KAAA,EAAAA,KAAA;IACAD,WAAWiE,UAAW,CAAAhD,EAAAA,CAAAA,MAAA,CAAG5B,WAA2B,EAAA,cAAA,CAAA,EAAA+B,OAAA,CAAQxB,OAAOI,SAAW,EAAAkE,eAAA,CAAAA,eAAA,CAAAA,eAAA,CAAAjD,EAAAA,EAAAA,EAAAA,CAAAA,MAAA,CACxE5B,WAAA,4BAAqCQ,OAAY,KAAA,SAAA,CAAAoB,EAAAA,EAAAA,CAAAA,MAAA,CACjD5B,WAAoC,EAAA,sBAAA,CAAA,EAAAQ,OAAA,CAAQuC,SAAS,QAAQ,CAAA,MAAAnB,MAAA,CAC7D5B,WAAA,EAA4CQ,8BAAAA,CAAAA,EAAAA,OAAY,KAAA,gBAAA,CAC7D,CAAA;GAAA,EAEAH,QAAY,IAAA4D,aAAA,EACZ,EAAAH,WAAA,EACH,CACF,CAAA,CAAA;AAEJ,EAAA;AAEAlE,UAAA,CAAWkF,WAAc,GAAA,YAAA;;;;AChIzB,IAAMX,KAAQ,GAAAY,qBAAA,CACZ,UAAC9E,KAAmB,EAAA0E,GAAA,EAAA;AAAA,EAAA,sBACjBZ,KAAA,CAAAC,aAAA,CAAAgB,KAAA,EAAAzC,aAAA,CAAA;AAAMoC,IAAAA,GAAA,EAAAA,GAAA;AAAUM,IAAAA,IAAK,EAAA,OAAA;AAAA,GAAA,EAAY/E,eAA4B,CAAAD,KAAA,EAAOiF,iBAAiB,CAAA,CAAG,CAAA,CAAA;AAAA,CAE3F,EAAA;AACEC,EAAAA,KAAO,EAAAvF,UAAA;AACPwE,EAAAA,MAAQ,eAAAgB,UAAA,CAAyC,UAACnF,KAAA,EAAO0E;0BACtDZ,KAAA,CAAAC,aAAA,CAAAgB,KAAA,EAAAzC,aAAA,CAAA;AAAMoC,MAAAA,GAAA,EAAAA,GAAA;AAAUM,MAAAA,IAAK,EAAA,cAAA;AAAA,KAAA,EAAmB/E,eAA4B,CAAAD,KAAA,EAAOiF,iBAAiB,CAAA,CAAG,CACjG,CAAA;AAAA,GAAA,CAAA;AACH,CACF,EAAA;AAEAf,KAAA,CAAMW,WAAc,GAAA,OAAA;;;;"}