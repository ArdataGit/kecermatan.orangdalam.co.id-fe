{"version":3,"file":"Tag.js","sources":["../../src/tag/Tag.tsx"],"sourcesContent":["import React, { ForwardRefRenderFunction, FocusEvent, forwardRef, useMemo } from 'react';\nimport classNames from 'classnames';\nimport { CloseIcon as TdCloseIcon } from 'tdesign-icons-react';\nimport tinycolor from 'tinycolor2';\n\nimport noop from '../_util/noop';\nimport useConfig from '../hooks/useConfig';\nimport useGlobalIcon from '../hooks/useGlobalIcon';\nimport { StyledProps } from '../common';\nimport { TdTagProps } from './type';\nimport { tagDefaultProps } from './defaultProps';\nimport useDefaultProps from '../hooks/useDefaultProps';\n\n/**\n * Tag 组件支持的属性。\n */\nexport interface TagProps extends TdTagProps, StyledProps {\n  /**\n   * 标签内容\n   */\n  children?: React.ReactNode;\n  tabIndex?: number;\n  onFocus?: (e: FocusEvent<HTMLDivElement>) => void;\n  onBlur?: (e: FocusEvent<HTMLDivElement>) => void;\n}\n\nexport const TagFunction: ForwardRefRenderFunction<HTMLDivElement, TagProps> = (originalProps, ref) => {\n  const props = useDefaultProps<TagProps>(originalProps, tagDefaultProps);\n  const {\n    theme,\n    size,\n    shape,\n    variant,\n    closable,\n    maxWidth,\n    icon,\n    content,\n    onClick = noop,\n    onClose = noop,\n    className,\n    style,\n    disabled,\n    children,\n    color,\n    ...otherTagProps\n  } = props;\n\n  const { classPrefix } = useConfig();\n  const { CloseIcon } = useGlobalIcon({\n    CloseIcon: TdCloseIcon,\n  });\n  const tagClassPrefix = `${classPrefix}-tag`;\n\n  const sizeMap = {\n    large: `${classPrefix}-size-l`,\n    small: `${classPrefix}-size-s`,\n  };\n\n  const tagClassNames = classNames(\n    tagClassPrefix,\n    `${tagClassPrefix}--${theme}`,\n    `${tagClassPrefix}--${variant}`,\n    {\n      [`${tagClassPrefix}--${shape}`]: shape !== 'square',\n      [`${tagClassPrefix}--ellipsis`]: !!maxWidth,\n      [`${tagClassPrefix}--disabled`]: disabled,\n    },\n    sizeMap[size],\n    className,\n  );\n\n  /**\n   * 删除 Icon\n   */\n  const deleteIcon = (\n    <CloseIcon\n      onClick={(e) => {\n        if (disabled) return;\n        onClose({ e });\n      }}\n      className={`${tagClassPrefix}__icon-close`}\n    />\n  );\n\n  const title = (() => {\n    if (children && typeof children === 'string') return children;\n    if (content && typeof content === 'string') return content;\n  })();\n  const titleAttribute = title ? { title } : undefined;\n\n  const getTagStyle = useMemo(() => {\n    if (!color) return style;\n    const luminance = tinycolor(color).getLuminance();\n\n    const calculatedStyle = style || {};\n\n    calculatedStyle.color = luminance > 0.5 ? 'black' : 'white';\n    if (variant === 'outline' || variant === 'light-outline') {\n      calculatedStyle.borderColor = color;\n    }\n\n    if (variant !== 'outline') {\n      const getLightestShade = () => {\n        const { r, g, b } = tinycolor(color).toRgb();\n        // alpha 0.1  is designed by @wen1kang\n        return `rgba(${r}, ${g}, ${b}, 0.1)`;\n      };\n\n      calculatedStyle.backgroundColor = variant === 'dark' ? color : getLightestShade();\n    }\n    if (variant !== 'dark') {\n      calculatedStyle.color = color;\n    }\n    return calculatedStyle;\n  }, [color, variant, style]);\n\n  const tag = (\n    <div\n      ref={ref}\n      className={tagClassNames}\n      onClick={(e) => {\n        if (disabled) return;\n        onClick({ e });\n      }}\n      style={\n        maxWidth ? { maxWidth: typeof maxWidth === 'number' ? `${maxWidth}px` : maxWidth, ...getTagStyle } : getTagStyle\n      }\n      {...otherTagProps}\n    >\n      <>\n        {icon}\n        <span className={maxWidth ? `${tagClassPrefix}--text` : undefined} {...titleAttribute}>\n          {children ?? content}\n        </span>\n        {closable && !disabled && deleteIcon}\n      </>\n    </div>\n  );\n\n  return tag;\n};\n\nexport const Tag = forwardRef(TagFunction);\n\nTag.displayName = 'Tag';\n\nexport default Tag;\n"],"names":["TagFunction","originalProps","ref","props","useDefaultProps","tagDefaultProps","theme","size","shape","variant","closable","maxWidth","icon","content","_props$onClick","onClick","noop","_props$onClose","onClose","className","style","disabled","children","color","otherTagProps","_objectWithoutProperties","_excluded","_useConfig","useConfig","classPrefix","_useGlobalIcon","useGlobalIcon","CloseIcon","TdCloseIcon","tagClassPrefix","sizeMap","large","small","tagClassNames","classNames","concat","_defineProperty","deleteIcon","React","createElement","e","title","titleAttribute","getTagStyle","useMemo","luminance","tinycolor","getLuminance","calculatedStyle","borderColor","getLightestShade","_tinycolor$toRgb","toRgb","r","g","b","backgroundColor","tag","_objectSpread","Fragment","Tag","forwardRef","displayName"],"mappings":"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"}