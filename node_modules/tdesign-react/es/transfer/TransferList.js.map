{"version":3,"file":"TransferList.js","sources":["../../src/transfer/TransferList.tsx"],"sourcesContent":["import React, { useMemo, useState } from 'react';\nimport classnames from 'classnames';\nimport isFunction from 'lodash/isFunction';\nimport isEmpty from 'lodash/isEmpty';\nimport isString from 'lodash/isString';\nimport { SearchIcon as TdSearchIcon } from 'tdesign-icons-react';\nimport { getLeafNodes } from './utils';\nimport useConfig from '../hooks/useConfig';\nimport useGlobalIcon from '../hooks/useGlobalIcon';\nimport { TdTransferProps, TransferValue } from './type';\nimport { TNode, StyledProps } from '../common';\nimport Checkbox from '../checkbox';\nimport Input from '../input';\nimport Pagination, { PaginationProps } from '../pagination';\nimport { useLocaleReceiver } from '../locale/LocalReceiver';\n\ninterface TransferListProps\n  extends Pick<TdTransferProps, 'data' | 'search' | 'checked' | 'transferItem' | 'tree'>,\n    StyledProps {\n  disabled?: boolean;\n  empty?: TNode | string;\n  title?: TNode;\n  footer?: TNode;\n  content?: TNode | TNode<{ data: Object }>;\n  pagination?: Pick<PaginationProps, 'pageSize'> & { onPageChange?: (current: number) => void };\n  onCheckbox?: (checked: Array<TransferValue>) => void;\n  onSearch?: (value: string) => void;\n  showCheckAll?: boolean;\n}\n\nconst TransferList: React.FunctionComponent<TransferListProps> = (props) => {\n  const {\n    className,\n    style,\n    data,\n    search = false,\n    checked = [],\n    empty,\n    title,\n    footer,\n    content,\n    onCheckbox,\n    onSearch,\n    disabled = false,\n    pagination,\n    transferItem,\n    tree: treeNode,\n    showCheckAll,\n  } = props;\n  const notDisabledData = !treeNode\n    ? data.filter((item) => !item.disabled)\n    : getLeafNodes(data).filter((item) => !item.disabled);\n  const [currentPage, setCurrentPage] = useState<number>(1);\n\n  const [indeterminate, allChecked] = useMemo(() => {\n    const activeLen = checked.length;\n    const notLen = notDisabledData.length;\n    return [activeLen && activeLen < notLen, activeLen && activeLen === notLen];\n  }, [checked, notDisabledData]);\n\n  const { classPrefix } = useConfig();\n  const { SearchIcon } = useGlobalIcon({\n    SearchIcon: TdSearchIcon,\n  });\n  const CLASSPREFIX = `${classPrefix}-transfer__list`;\n  const [local, t] = useLocaleReceiver('transfer');\n\n  const handleCheckbox = (vals: Array<TransferValue>) => {\n    if (isFunction(onCheckbox)) onCheckbox(vals);\n  };\n\n  const handleAllCheckbox = (checked: boolean) => {\n    if (isFunction(onCheckbox)) onCheckbox(checked ? notDisabledData.map((item) => item.value) : []);\n  };\n\n  const HeaderCmp = () => {\n    const total = treeNode ? getLeafNodes(data).length : data.length;\n    return (\n      <div className={`${CLASSPREFIX}-header`}>\n        <div>\n          {showCheckAll ? (\n            <Checkbox\n              indeterminate={indeterminate}\n              checked={allChecked}\n              disabled={disabled}\n              onChange={handleAllCheckbox}\n            />\n          ) : null}\n          <span>{t(local.title, { checked: checked.length, total })}</span>\n        </div>\n        <span>{title}</span>\n      </div>\n    );\n  };\n\n  const SearchCmp = () =>\n    search ? (\n      <div className={`${classPrefix}-transfer__search-wrapper`}>\n        <Input placeholder={local.placeholder} suffixIcon={<SearchIcon></SearchIcon>} onChange={onSearch}></Input>\n      </div>\n    ) : null;\n\n  const viewData = useMemo(() => {\n    if (!isEmpty(pagination)) {\n      const pageSize = pagination.pageSize || 10;\n      const start = (currentPage - 1) * pageSize;\n      return data.slice(start, start + pageSize);\n    }\n    return data;\n  }, [currentPage, data, pagination]);\n\n  const EmptyCmp = () =>\n    isString(empty) ? (\n      <div className={`${classPrefix}-transfer__empty`}>\n        <span>{empty || '暂无数据'}</span>\n      </div>\n    ) : (\n      empty\n    );\n\n  const contentCmp = () => {\n    if (typeof treeNode === 'function') {\n      return treeNode({ data: viewData, value: checked, onChange: handleCheckbox });\n    }\n    if (typeof content === 'function') {\n      return content({ data: viewData });\n    }\n    return (\n      <Checkbox.Group value={checked} onChange={handleCheckbox} disabled={disabled}>\n        {viewData.map((item, index) => (\n          <Checkbox key={item.value} value={item.value} disabled={item.disabled} className={`${CLASSPREFIX}-item`}>\n            <span>\n              {typeof transferItem === 'function' ? transferItem({ data: item, index, type: 'source' }) : item.label}\n            </span>\n          </Checkbox>\n        ))}\n      </Checkbox.Group>\n    );\n  };\n  const BodyCmp = () => (\n    <div\n      className={classnames(`${CLASSPREFIX}-body`, {\n        [`${CLASSPREFIX}--with-search`]: search,\n      })}\n    >\n      {SearchCmp()}\n      <div className={`${CLASSPREFIX}-content narrow-scrollbar`}>{viewData.length ? contentCmp() : EmptyCmp()}</div>\n    </div>\n  );\n\n  const PaginationCmp = () => {\n    const handleCurrentPagination = (current: number) => {\n      setCurrentPage(current);\n      if (isFunction(pagination.onPageChange)) {\n        pagination.onPageChange(current);\n      }\n    };\n\n    return pagination ? (\n      <div className={`${CLASSPREFIX}-pagination`}>\n        <Pagination\n          size=\"small\"\n          theme=\"simple\"\n          pageSizeOptions={[]}\n          total={data.length}\n          totalContent={false}\n          onCurrentChange={handleCurrentPagination}\n          pageSize={pagination.pageSize}\n        />\n      </div>\n    ) : null;\n  };\n\n  const footerCmp = () => (!isEmpty(footer) ? <div className={`${classPrefix}-transfer__footer`}>{footer}</div> : null);\n\n  return (\n    <div style={style} className={classnames(CLASSPREFIX, className)}>\n      {HeaderCmp()}\n      {BodyCmp()}\n      {PaginationCmp()}\n      {footerCmp()}\n    </div>\n  );\n};\n\nexport default TransferList;\n"],"names":["TransferList","props","className","style","data","_props$search","search","_props$checked","checked","empty","title","footer","content","onCheckbox","onSearch","_props$disabled","disabled","pagination","transferItem","treeNode","tree","showCheckAll","notDisabledData","filter","item","getLeafNodes","_useState","useState","_useState2","_slicedToArray","currentPage","setCurrentPage","_useMemo","useMemo","activeLen","length","notLen","_useMemo2","indeterminate","allChecked","_useConfig","useConfig","classPrefix","_useGlobalIcon","useGlobalIcon","SearchIcon","TdSearchIcon","CLASSPREFIX","_useLocaleReceiver","useLocaleReceiver","_useLocaleReceiver2","local","t","handleCheckbox","vals","isFunction","handleAllCheckbox","map","value","HeaderCmp","total","React","createElement","Checkbox","onChange","SearchCmp","Input","placeholder","suffixIcon","viewData","isEmpty","pageSize","start","slice","EmptyCmp","isString","contentCmp","Group","index","key","type","label","BodyCmp","classnames","concat","_defineProperty","PaginationCmp","handleCurrentPagination","current","onPageChange","Pagination","size","theme","pageSizeOptions","totalContent","onCurrentChange","footerCmp"],"mappings":"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"}