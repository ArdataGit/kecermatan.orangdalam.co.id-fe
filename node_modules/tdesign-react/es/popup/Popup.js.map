{"version":3,"file":"Popup.js","sources":["../../src/popup/Popup.tsx"],"sourcesContent":["import React, { forwardRef, useState, useRef, useMemo, useEffect, useImperativeHandle } from 'react';\nimport { CSSTransition } from 'react-transition-group';\nimport isFunction from 'lodash/isFunction';\nimport debounce from 'lodash/debounce';\nimport classNames from 'classnames';\nimport { usePopper } from 'react-popper';\nimport { Placement } from '@popperjs/core';\nimport useControlled from '../hooks/useControlled';\nimport useAnimation from '../_util/useAnimation';\nimport useConfig from '../hooks/useConfig';\nimport { TdPopupProps } from './type';\nimport Portal from '../common/Portal';\nimport useTrigger from './hooks/useTrigger';\nimport { getRefDom } from './utils/ref';\nimport { getTransitionParams } from './utils/transition';\nimport useMutationObserver from '../_util/useMutationObserver';\nimport useWindowSize from '../_util/useWindowSize';\nimport { popupDefaultProps } from './defaultProps';\nimport useDefaultProps from '../hooks/useDefaultProps';\n\nexport interface PopupProps extends TdPopupProps {\n  // 是否触发展开收起动画，内部下拉式组件使用\n  expandAnimation?: boolean;\n  // 更新内容区域滚动条\n  updateScrollTop?: (content: HTMLDivElement) => void;\n}\n\nexport interface PopupRef {\n  /** 获取 popper 实例 */\n  getPopper: () => ReturnType<typeof usePopper>;\n  /** 获取 Popup dom 元素 */\n  getPopupElement: () => HTMLDivElement;\n  /** 获取 portal dom 元素 */\n  getPortalElement: () => HTMLDivElement;\n  /** 获取内容区域 dom 元素 */\n  getPopupContentElement: () => HTMLDivElement;\n  /** 设置 popup 显示隐藏 */\n  setVisible: (visible: boolean) => void;\n}\n\nconst Popup = forwardRef<PopupRef, PopupProps>((originalProps, ref) => {\n  const props = useDefaultProps<PopupProps>(originalProps, popupDefaultProps);\n  const {\n    trigger,\n    content,\n    placement,\n    attach,\n    showArrow,\n    destroyOnClose,\n    overlayClassName,\n    overlayInnerClassName,\n    overlayStyle,\n    overlayInnerStyle,\n    triggerElement,\n    children = triggerElement,\n    disabled,\n    zIndex,\n    onScroll,\n    onScrollToBottom,\n    expandAnimation,\n    delay,\n    hideEmptyPopup,\n    popperOptions,\n    updateScrollTop,\n  } = props;\n  const { classPrefix } = useConfig();\n\n  // 全局配置\n  const { keepExpand, keepFade } = useAnimation();\n  const { height: windowHeight, width: windowWidth } = useWindowSize();\n  const [visible, onVisibleChange] = useControlled(props, 'visible', props.onVisibleChange);\n\n  const [popupElement, setPopupElement] = useState(null);\n  const triggerRef = useRef(null); // 记录 trigger 元素\n  const popupRef = useRef(null); // popup dom 元素，css transition 需要用\n  const portalRef = useRef(null); // portal dom 元素\n  const contentRef = useRef(null); // 内容部分\n  const popperRef = useRef(null); // 保存 popper 实例\n\n  // 默认动画时长\n  const DEFAULT_TRANSITION_TIMEOUT = 180;\n\n  // 判断展示浮层\n  const showOverlay = useMemo(() => {\n    if (hideEmptyPopup && !content) return false;\n    return visible || popupElement;\n  }, [hideEmptyPopup, content, visible, popupElement]);\n\n  // 转化 placement\n  const popperPlacement = useMemo(\n    () => placement.replace(/-(left|top)$/, '-start').replace(/-(right|bottom)$/, '-end') as Placement,\n    [placement],\n  );\n\n  const { getTriggerNode, getPopupProps, getTriggerDom } = useTrigger({\n    triggerRef,\n    content,\n    disabled,\n    trigger,\n    visible,\n    delay,\n    onVisibleChange,\n  });\n\n  popperRef.current = usePopper(getRefDom(triggerRef), popupElement, {\n    placement: popperPlacement,\n    ...popperOptions,\n  });\n  const { styles, attributes } = popperRef.current;\n\n  const triggerNode = isFunction(children) ? getTriggerNode(children({ visible })) : getTriggerNode(children);\n\n  const updateTimeRef = useRef(null);\n  // 监听 trigger 节点或内容变化动态更新 popup 定位\n  useMutationObserver(getRefDom(triggerRef), () => {\n    clearTimeout(updateTimeRef.current);\n    updateTimeRef.current = setTimeout(() => popperRef.current?.update?.(), 0);\n  });\n  useEffect(() => () => clearTimeout(updateTimeRef.current), []);\n\n  // 窗口尺寸变化时调整位置\n  useEffect(() => {\n    requestAnimationFrame(() => popperRef.current?.update?.());\n  }, [visible, content, windowHeight, windowWidth]);\n\n  // 下拉展开时更新内部滚动条\n  useEffect(() => {\n    if (!triggerRef.current) triggerRef.current = getTriggerDom();\n    if (visible) {\n      updateScrollTop?.(contentRef.current);\n    }\n  }, [visible, updateScrollTop, getTriggerDom]);\n\n  function handleExited() {\n    !destroyOnClose && popupElement && (popupElement.style.display = 'none');\n  }\n  function handleEnter() {\n    !destroyOnClose && popupElement && (popupElement.style.display = 'block');\n  }\n\n  function handleScroll(e: React.WheelEvent<HTMLDivElement>) {\n    onScroll?.({ e });\n\n    // 防止多次触发添加截流\n    const debounceOnScrollBottom = debounce((e) => onScrollToBottom?.({ e }), 100);\n\n    const { scrollTop, clientHeight, scrollHeight } = e.target as HTMLDivElement;\n    // windows 下滚动会出现小数，所以这里取整\n    if (clientHeight + Math.floor(scrollTop) === scrollHeight) {\n      // touch bottom\n      debounceOnScrollBottom(e);\n    }\n  }\n\n  // 整理浮层样式\n  function getOverlayStyle(overlayStyle: TdPopupProps['overlayStyle']) {\n    if (getRefDom(triggerRef) && popupRef.current && typeof overlayStyle === 'function') {\n      return { ...overlayStyle(getRefDom(triggerRef), popupRef.current) };\n    }\n    return { ...overlayStyle };\n  }\n\n  const overlay = showOverlay && (\n    <CSSTransition\n      appear\n      in={visible}\n      timeout={DEFAULT_TRANSITION_TIMEOUT}\n      nodeRef={portalRef}\n      unmountOnExit={destroyOnClose}\n      onEnter={handleEnter}\n      onExited={handleExited}\n    >\n      <Portal triggerNode={getRefDom(triggerRef)} attach={attach} ref={portalRef}>\n        <CSSTransition\n          appear\n          timeout={0}\n          in={visible}\n          nodeRef={popupRef}\n          {...getTransitionParams({\n            classPrefix,\n            fadeAnimation: keepFade,\n            expandAnimation: expandAnimation && keepExpand,\n          })}\n        >\n          <div\n            ref={(node) => {\n              if (node) {\n                popupRef.current = node;\n                setPopupElement(node);\n              }\n            }}\n            style={{ ...styles.popper, zIndex, ...getOverlayStyle(overlayStyle) }}\n            className={classNames(`${classPrefix}-popup`, overlayClassName)}\n            {...attributes.popper}\n            {...getPopupProps()}\n          >\n            <div\n              ref={contentRef}\n              className={classNames(\n                `${classPrefix}-popup__content`,\n                {\n                  [`${classPrefix}-popup__content--arrow`]: showArrow,\n                },\n                overlayInnerClassName,\n              )}\n              style={getOverlayStyle(overlayInnerStyle)}\n              onScroll={handleScroll}\n            >\n              {content}\n              {showArrow ? <div style={styles.arrow} className={`${classPrefix}-popup__arrow`} /> : null}\n            </div>\n          </div>\n        </CSSTransition>\n      </Portal>\n    </CSSTransition>\n  );\n\n  useImperativeHandle(ref, () => ({\n    getPopper: () => popperRef.current,\n    getPopupElement: () => popupRef.current,\n    getPortalElement: () => portalRef.current,\n    getPopupContentElement: () => contentRef.current,\n    setVisible: (visible: boolean) => onVisibleChange(visible, { trigger: 'document' }),\n  }));\n\n  return (\n    <React.Fragment>\n      {triggerNode}\n      {overlay}\n    </React.Fragment>\n  );\n});\n\nPopup.displayName = 'Popup';\n\nexport default Popup;\n"],"names":["Popup","forwardRef","originalProps","ref","props","useDefaultProps","popupDefaultProps","trigger","content","placement","attach","showArrow","destroyOnClose","overlayClassName","overlayInnerClassName","overlayStyle","overlayInnerStyle","triggerElement","_props$children","children","disabled","zIndex","onScroll","onScrollToBottom","expandAnimation","delay","hideEmptyPopup","popperOptions","updateScrollTop","_useConfig","useConfig","classPrefix","_useAnimation","useAnimation","keepExpand","keepFade","_useWindowSize","useWindowSize","windowHeight","height","windowWidth","width","_useControlled","useControlled","onVisibleChange","_useControlled2","_slicedToArray","visible","_useState","useState","_useState2","popupElement","setPopupElement","triggerRef","useRef","popupRef","portalRef","contentRef","popperRef","DEFAULT_TRANSITION_TIMEOUT","showOverlay","useMemo","popperPlacement","replace","_useTrigger","useTrigger","getTriggerNode","getPopupProps","getTriggerDom","current","usePopper","getRefDom","_objectSpread","_popperRef$current","styles","attributes","triggerNode","isFunction","updateTimeRef","useMutationObserver","clearTimeout","setTimeout","_popperRef$current2","_popperRef$current2$u","update","call","useEffect","requestAnimationFrame","_popperRef$current3","_popperRef$current3$u","handleExited","style","display","handleEnter","handleScroll","e","debounceOnScrollBottom","debounce","_e$target","target","scrollTop","clientHeight","scrollHeight","Math","floor","getOverlayStyle","overlay","React","createElement","CSSTransition","appear","timeout","nodeRef","unmountOnExit","onEnter","onExited","Portal","getTransitionParams","fadeAnimation","node","popper","className","classNames","concat","_defineProperty","arrow","useImperativeHandle","getPopper","getPopupElement","getPortalElement","getPopupContentElement","setVisible","Fragment","displayName"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAwCMA,IAAAA,KAAQ,gBAAAC,UAAA,CAAiC,UAACC,aAAA,EAAeC,GAAQ,EAAA;AAC/D,EAAA,IAAAC,KAAA,GAAQC,eAA4B,CAAAH,aAAA,EAAeI,iBAAiB,CAAA,CAAA;AACpE,EAAA,IACJC,OAAA,GAqBEH,KAAA,CArBFG,OAAA;IACAC,OAAA,GAoBEJ,KAAA,CApBFI,OAAA;IACAC,SAAA,GAmBEL,KAAA,CAnBFK,SAAA;IACAC,MAAA,GAkBEN,KAAA,CAlBFM,MAAA;IACAC,SAAA,GAiBEP,KAAA,CAjBFO,SAAA;IACAC,cAAA,GAgBER,KAAA,CAhBFQ,cAAA;IACAC,gBAAA,GAeET,KAAA,CAfFS,gBAAA;IACAC,qBAAA,GAcEV,KAAA,CAdFU,qBAAA;IACAC,YAAA,GAaEX,KAAA,CAbFW,YAAA;IACAC,iBAAA,GAYEZ,KAAA,CAZFY,iBAAA;IACAC,cAAA,GAWEb,KAAA,CAXFa,cAAA;IAAAC,eAAA,GAWEd,KAAA,CAVFe,QAAW;AAAXA,IAAAA,QAAW,GAAAD,eAAA,KAAAD,KAAAA,CAAAA,GAAAA,cAAA,GAAAC,eAAA;IACXE,QAAA,GASEhB,KAAA,CATFgB,QAAA;IACAC,MAAA,GAQEjB,KAAA,CARFiB,MAAA;IACAC,QAAA,GAOElB,KAAA,CAPFkB,QAAA;IACAC,gBAAA,GAMEnB,KAAA,CANFmB,gBAAA;IACAC,eAAA,GAKEpB,KAAA,CALFoB,eAAA;IACAC,KAAA,GAIErB,KAAA,CAJFqB,KAAA;IACAC,cAAA,GAGEtB,KAAA,CAHFsB,cAAA;IACAC,aAAA,GAEEvB,KAAA,CAFFuB,aAAA;IACAC,eAAA,GACExB,KAAA,CADFwB,eAAA,CAAA;AAEI,EAAA,IAAAC,UAAA,GAAkBC,SAAU,EAAA;IAA1BC,WAAY,GAAAF,UAAA,CAAZE,WAAY,CAAA;AAGpB,EAAA,IAAAC,aAAA,GAAiCC,YAAa,EAAA;IAAtCC,UAAA,GAAAF,aAAA,CAAAE,UAAA;IAAYC,QAAS,GAAAH,aAAA,CAATG,QAAS,CAAA;AAC7B,EAAA,IAAAC,cAAA,GAAqDC,aAAc,EAAA;IAAnDC,YAAA,GAAAF,cAAA,CAARG,MAAQ;IAAqBC,WAAA,GAAAJ,cAAA,CAAPK,KAAO,CAAA;EAC/B,IAAAC,cAAA,GAA6BC,cAAcvC,KAAO,EAAA,SAAA,EAAWA,MAAMwC,eAAe,CAAA;IAAAC,eAAA,GAAAC,cAAA,CAAAJ,cAAA,EAAA,CAAA,CAAA;AAAjFK,IAAAA;AAASH,IAAAA,eAAe,GAAAC,eAAA,CAAA,CAAA,CAAA,CAAA;AAE/B,EAAA,IAAAG,SAAA,GAAwCC,SAAS,IAAI,CAAA;IAAAC,UAAA,GAAAJ,cAAA,CAAAE,SAAA,EAAA,CAAA,CAAA;AAA9CG,IAAAA,YAAA,GAAAD,UAAA,CAAA,CAAA,CAAA;AAAcE,IAAAA,eAAe,GAAAF,UAAA,CAAA,CAAA,CAAA,CAAA;AAC9B,EAAA,IAAAG,UAAA,GAAaC,OAAO,IAAI,CAAA,CAAA;AACxB,EAAA,IAAAC,QAAA,GAAWD,OAAO,IAAI,CAAA,CAAA;AACtB,EAAA,IAAAE,SAAA,GAAYF,OAAO,IAAI,CAAA,CAAA;AACvB,EAAA,IAAAG,UAAA,GAAaH,OAAO,IAAI,CAAA,CAAA;AACxB,EAAA,IAAAI,SAAA,GAAYJ,OAAO,IAAI,CAAA,CAAA;EAG7B,IAAMK,0BAA6B,GAAA,GAAA,CAAA;AAG7B,EAAA,IAAAC,WAAA,GAAcC,QAAQ,YAAM;AAChC,IAAA,IAAInC,kBAAkB,CAAClB,OAAA,EAAgB,OAAA,KAAA,CAAA;IACvC,OAAOuC,OAAW,IAAAI,YAAA,CAAA;KACjB,CAACzB,cAAA,EAAgBlB,OAAS,EAAAuC,OAAA,EAASI,YAAY,CAAC,CAAA,CAAA;EAGnD,IAAMW,eAAkB,GAAAD,OAAA,CACtB,YAAA;AAAA,IAAA,OAAMpD,UAAUsD,OAAQ,CAAA,cAAA,EAAgB,QAAQ,CAAE,CAAAA,OAAA,CAAQ,oBAAoB,MAAM,CAAA,CAAA;GACpF,EAAA,CAACtD,SAAS,CACZ,CAAA,CAAA;EAEA,IAAAuD,WAAA,GAAyDC,UAAW,CAAA;AAClEZ,MAAAA,UAAA,EAAAA,UAAA;AACA7C,MAAAA,OAAA,EAAAA,OAAA;AACAY,MAAAA,QAAA,EAAAA,QAAA;AACAb,MAAAA,OAAA,EAAAA,OAAA;AACAwC,MAAAA,OAAA,EAAAA,OAAA;AACAtB,MAAAA,KAAA,EAAAA,KAAA;AACAmB,MAAAA,eAAA,EAAAA,eAAAA;AACF,KAAC,CAAA;IAROsB,cAAA,GAAAF,WAAA,CAAAE,cAAA;IAAgBC,aAAe,GAAAH,WAAA,CAAfG,aAAe;IAAAC,aAAA,GAAAJ,WAAA,CAAAI,aAAA,CAAA;AAUvCV,EAAAA,SAAA,CAAUW,OAAU,GAAAC,SAAA,CAAUC,SAAU,CAAAlB,UAAU,GAAGF,YAAc,EAAAqB,aAAA,CAAA;AACjE/D,IAAAA,SAAW,EAAAqD,eAAAA;GACRnC,EAAAA,aAAA,CACJ,CAAA,CAAA;AACD,EAAA,IAAA8C,kBAAA,GAA+Bf,SAAU,CAAAW,OAAA;IAAjCK,MAAA,GAAAD,kBAAA,CAAAC,MAAA;IAAQC,UAAW,GAAAF,kBAAA,CAAXE,UAAW,CAAA;EAE3B,IAAMC,WAAc,GAAAC,YAAA,CAAW1D,QAAQ,CAAA,GAAI+C,cAAe,CAAA/C,QAAA,CAAS;AAAE4B,IAAAA,OAAA,EAAAA,OAAAA;AAAQ,GAAC,CAAC,CAAI,GAAAmB,cAAA,CAAe/C,QAAQ,CAAA,CAAA;AAEpG,EAAA,IAAA2D,aAAA,GAAgBxB,OAAO,IAAI,CAAA,CAAA;AAEbyB,EAAAA,qBAAA,CAAAR,SAAA,CAAUlB,UAAU,CAAA,EAAG,YAAM;AAC/C2B,IAAAA,YAAA,CAAaF,cAAcT,OAAO,CAAA,CAAA;AAClCS,IAAAA,aAAA,CAAcT,UAAUY,UAAW,CAAA,YAAA;MAAA,IAAAC,mBAAA,EAAAC,qBAAA,CAAA;MAAA,OAAAD,CAAAA,mBAAA,GAAMxB,UAAUW,OAAS,MAAAa,IAAAA,IAAAA,mBAAA,gBAAAC,qBAAA,GAAnBD,mBAAA,CAAmBE,MAAA,cAAAD,qBAAA,KAAA,KAAA,CAAA,GAAA,KAAA,CAAA,GAAnBA,qBAAA,CAAAE,IAAA,CAAAH,mBAA4B;OAAG,CAAC,CAAA,CAAA;AAC3E,GAAC,CAAA,CAAA;AACDI,EAAAA,SAAA,CAAU,YAAA;IAAA,OAAM,YAAA;AAAA,MAAA,OAAMN,YAAA,CAAaF,cAAcT,OAAO,CAAA,CAAA;AAAA,KAAA,CAAA;AAAA,GAAA,EAAG,EAAE,CAAA,CAAA;AAG7DiB,EAAAA,SAAA,CAAU,YAAM;AACdC,IAAAA,qBAAA,CAAsB,YAAA;MAAA,IAAAC,mBAAA,EAAAC,qBAAA,CAAA;MAAA,OAAAD,CAAAA,mBAAA,GAAM9B,SAAA,CAAUW,OAAS,MAAAmB,IAAAA,IAAAA,mBAAA,gBAAAC,qBAAA,GAAnBD,mBAAA,CAAmBJ,MAAA,cAAAK,qBAAA,KAAA,KAAA,CAAA,GAAA,KAAA,CAAA,GAAnBA,qBAAA,CAAAJ,IAAA,CAAAG,mBAA4B,CAAC,CAAA;KAAA,CAAA,CAAA;KACxD,CAACzC,OAAA,EAASvC,OAAS,EAAA8B,YAAA,EAAcE,WAAW,CAAC,CAAA,CAAA;AAGhD8C,EAAAA,SAAA,CAAU,YAAM;IACd,IAAI,CAACjC,UAAW,CAAAgB,OAAA,EAAShB,UAAA,CAAWgB,UAAUD,aAAc,EAAA,CAAA;AAC5D,IAAA,IAAIrB,OAAS,EAAA;MACXnB,eAAA,KAAA,IAAA,IAAAA,eAAA,KAAAA,KAAAA,CAAAA,IAAAA,eAAA,CAAkB6B,WAAWY,OAAO,CAAA,CAAA;AACtC,KAAA;GACC,EAAA,CAACtB,OAAS,EAAAnB,eAAA,EAAiBwC,aAAa,CAAC,CAAA,CAAA;EAE5C,SAASsB,YAAeA,GAAA;IACtB,CAAC9E,cAAkB,IAAAuC,YAAA,KAAiBA,YAAa,CAAAwC,KAAA,CAAMC,OAAU,GAAA,MAAA,CAAA,CAAA;AACnE,GAAA;EACA,SAASC,WAAcA,GAAA;IACrB,CAACjF,cAAkB,IAAAuC,YAAA,KAAiBA,YAAa,CAAAwC,KAAA,CAAMC,OAAU,GAAA,OAAA,CAAA,CAAA;AACnE,GAAA;EAEA,SAASE,aAAaC,CAAqC,EAAA;AAC9CzE,IAAAA,QAAA,KAAAA,IAAAA,IAAAA,QAAA,KAAAA,KAAAA,CAAAA,IAAAA,QAAA,CAAA;AAAEyE,MAAAA,GAAAA,CAAAA;AAAE,KAAC,CAAA,CAAA;AAGV,IAAA,IAAAC,sBAAA,GAAyBC,UAAS,CAAA,UAACF,EAAM,EAAA;AAAA,MAAA,OAAAxE,gBAAA,KAAA,IAAA,IAAAA,gBAAA,KAAA,KAAA,CAAA,GAAA,KAAA,CAAA,GAAAA,gBAAA,CAAmB;AAAEwE,QAAAA,CAAAA,EAAAA,EAAAA;AAAE,OAAC,CAAA,CAAA;AAAA,KAAA,EAAG,GAAG,CAAA,CAAA;AAE7E,IAAA,IAAAG,SAAA,GAAkDH,CAAE,CAAAI,MAAA;MAA5CC,SAAA,GAAAF,SAAA,CAAAE,SAAA;MAAWC,YAAc,GAAAH,SAAA,CAAdG,YAAc;MAAAC,YAAA,GAAAJ,SAAA,CAAAI,YAAA,CAAA;IAEjC,IAAID,YAAe,GAAAE,IAAA,CAAKC,KAAM,CAAAJ,SAAS,MAAME,YAAc,EAAA;MAEzDN,sBAAA,CAAuBD,CAAC,CAAA,CAAA;AAC1B,KAAA;AACF,GAAA;EAGA,SAASU,gBAAgB1F,aAA4C,EAAA;AACnE,IAAA,IAAIwD,UAAUlB,UAAU,CAAA,IAAKE,SAASc,OAAW,IAAA,OAAOtD,kBAAiB,UAAY,EAAA;AAC5E,MAAA,OAAAyD,aAAA,CAAA,EAAA,EAAKzD,aAAa,CAAAwD,SAAA,CAAUlB,UAAU,CAAG,EAAAE,QAAA,CAASc,OAAO,CAAE,CAAA,CAAA;AACpE,KAAA;IACO,OAAAG,aAAA,KAAKzD,aAAa,CAAA,CAAA;AAC3B,GAAA;EAEM,IAAA2F,OAAA,GAAU9C,8BACb+C,KAAA,CAAAC,aAAA,CAAAC,aAAA,EAAA;AACCC,IAAAA,MAAM,EAAA,IAAA;AACN,IAAA,IAAA,EAAI/D,OAAA;AACJgE,IAAAA,OAAS,EAAApD,0BAAA;AACTqD,IAAAA,OAAS,EAAAxD,SAAA;AACTyD,IAAAA,aAAe,EAAArG,cAAA;AACfsG,IAAAA,OAAS,EAAArB,WAAA;AACTsB,IAAAA,QAAU,EAAAzB,YAAAA;AAAA,GAAA,iBAETiB,KAAA,CAAAC,aAAA,CAAAQ,MAAA,EAAA;AAAOxC,IAAAA,WAAA,EAAaL,UAAUlB,UAAU,CAAA;AAAG3C,IAAAA,MAAA,EAAAA,MAAA;AAAgBP,IAAAA,GAAK,EAAAqD,SAAAA;GAAA,iBAC9DmD,KAAA,CAAAC,aAAA,CAAAC,aAAA,EAAArC,aAAA,CAAA;AACCsC,IAAAA,MAAM,EAAA,IAAA;AACNC,IAAAA,OAAS,EAAA,CAAA;AACT,IAAA,IAAA,EAAIhE,OAAA;AACJiE,IAAAA,OAAS,EAAAzD,QAAAA;AAAA,GAAA,EACL8D,mBAAoB,CAAA;AACtBtF,IAAAA,WAAA,EAAAA,WAAA;AACAuF,IAAAA,aAAe,EAAAnF,QAAA;IACfX,iBAAiBA,eAAmB,IAAAU,UAAAA;GACrC,CAAA,CAED,iBAACyE,KAAA,CAAAC,aAAA,CAAA,KAAA,EAAApC,aAAA,CAAAA,aAAA,CAAA;AACCrE,IAAAA,GAAA,EAAK,SAAAA,GAACoH,CAAAA,IAAS,EAAA;AACb,MAAA,IAAIA,IAAM,EAAA;QACRhE,QAAA,CAASc,OAAU,GAAAkD,IAAA,CAAA;QACnBnE,eAAA,CAAgBmE,IAAI,CAAA,CAAA;AACtB,OAAA;KACF;AACA5B,IAAAA,KAAA,EAAAnB,aAAA,CAAAA,aAAA,CAAYE,EAAAA,EAAAA,MAAA,CAAO8C;AAAQnG,MAAAA,MAAQ,EAARA,MAAAA;AAAQ,KAAA,EAAGoF,eAAgB,CAAA1F,YAAY,CAAE,CAAA;AACpE0G,IAAAA,SAAW,EAAAC,UAAA,CAAA,EAAA,CAAAC,MAAA,CAAc5F,WAAA,aAAqBlB,gBAAgB,CAAA;AAAA,GAAA,EAC1D8D,UAAW,CAAA6C,MAAA,CAAA,EACXrD,aAAc,EAAA,CAElB,iBAACwC,KAAA,CAAAC,aAAA,CAAA,KAAA,EAAA;AACCzG,IAAAA,GAAK,EAAAsD,UAAA;AACLgE,IAAAA,SAAW,EAAAC,UAAA,CAAA,EAAA,CAAAC,MAAA,CACN5F,WAAA,EAAA6F,iBAAAA,CAAAA,EAAAA,eAAA,CAAAD,EAAAA,EAAAA,EAAAA,CAAAA,MAAA,CAEG5F,WAAsC,EAAA,wBAAA,CAAA,EAAApB,SAAA,CAAA,EAE5CG,qBACF,CAAA;AACA6E,IAAAA,KAAA,EAAOc,gBAAgBzF,iBAAiB,CAAA;AACxCM,IAAAA,QAAU,EAAAwE,YAAAA;GAET,EAAAtF,OAAA,EACAG,2BAAagG,KAAA,CAAAC,aAAA,CAAA,KAAA,EAAA;IAAIjB,OAAOjB,MAAO,CAAAmD,KAAA;IAAOJ,qBAAc1F,WAAA,EAAA,eAAA,CAAA;AAAA,GAA4B,CAAK,GAAA,IACxF,CACF,CACF,CACF,CACF,CAAA,CAAA;EAGF+F,mBAAA,CAAoB3H,KAAK,YAAA;IAAA,OAAO;MAC9B4H,SAAA,EAAW,SAAAA,SAAA,GAAA;QAAA,OAAMrE,SAAU,CAAAW,OAAA,CAAA;AAAA,OAAA;MAC3B2D,eAAA,EAAiB,SAAAA,eAAA,GAAA;QAAA,OAAMzE,QAAS,CAAAc,OAAA,CAAA;AAAA,OAAA;MAChC4D,gBAAA,EAAkB,SAAAA,gBAAA,GAAA;QAAA,OAAMzE,SAAU,CAAAa,OAAA,CAAA;AAAA,OAAA;MAClC6D,sBAAA,EAAwB,SAAAA,sBAAA,GAAA;QAAA,OAAMzE,UAAW,CAAAY,OAAA,CAAA;AAAA,OAAA;MACzC8D,UAAA,EAAY,SAAAA,UAAAA,CAACpF,QAAqB,EAAA;QAAA,OAAAH,eAAA,CAAgBG,UAAS;AAAExC,UAAAA,OAAA,EAAS,UAAA;AAAW,SAAC,CAAA,CAAA;AAAA,OAAA;KAClF,CAAA;AAAA,GAAA,CAAA,CAAA;AAEF,EAAA,sBACGoG,KAAA,CAAAC,aAAA,CAAAD,KAAA,CAAMyB,QAAN,EAAA,IAAA,EACExD,aACA8B,OACH,CAAA,CAAA;AAEJ,CAAC,EAAA;AAED1G,KAAA,CAAMqI,WAAc,GAAA,OAAA;;;;"}