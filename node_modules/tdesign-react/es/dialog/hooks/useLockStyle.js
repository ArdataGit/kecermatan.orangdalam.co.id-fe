/**
 * tdesign v1.7.1
 * (c) 2024 tdesign
 * @license MIT
 */

import { useRef, useCallback } from 'react';
import useIsomorphicLayoutEffect from '../../_util/useLayoutEffect.js';
import { getScrollbarWidth } from '../../_common/js/utils/getScrollbarWidth.js';
import '../../_util/dom.js';
import 'raf';
import '../../_chunks/dep-3f719063.js';
import '../../_chunks/dep-08fc9b22.js';
import '../../_chunks/dep-f3bac8f4.js';
import '../../_chunks/dep-9d4210ce.js';
import '../../_chunks/dep-17c2aa2b.js';
import '../../_chunks/dep-dc4499f2.js';
import '../../_util/easing.js';
import '../../_common/js/utils/helper.js';
import '../../_chunks/dep-1336b163.js';
import '../../_chunks/dep-e0a22ada.js';
import '../../_chunks/dep-97526c3e.js';
import '../../_chunks/dep-be37289b.js';
import '../../_chunks/dep-9d06ffd4.js';
import '../../_chunks/dep-72e0f3fe.js';
import '../../_chunks/dep-f2dd6554.js';
import '../../_chunks/dep-05f57d79.js';

var key = 1;
function useDialogLockStyle(_ref) {
  var preventScrollThrough = _ref.preventScrollThrough,
    visible = _ref.visible,
    mode = _ref.mode,
    showInAttachedElement = _ref.showInAttachedElement;
  var lockStyleRef = useRef(null);
  var timerRef = useRef(null);
  var clearStyleFunc = useCallback(function () {
    clearTimeout(timerRef.current);
    timerRef.current = setTimeout(function () {
      var _lockStyleRef$current, _lockStyleRef$current2;
      (_lockStyleRef$current = lockStyleRef.current.parentNode) === null || _lockStyleRef$current === void 0 || (_lockStyleRef$current2 = _lockStyleRef$current.removeChild) === null || _lockStyleRef$current2 === void 0 || _lockStyleRef$current2.call(_lockStyleRef$current, lockStyleRef.current);
    }, 150);
  }, []);
  useIsomorphicLayoutEffect(function () {
    if (typeof document === "undefined") return;
    if (!lockStyleRef.current) {
      lockStyleRef.current = document.createElement("style");
    }
    var hasScrollBar = document.documentElement.scrollHeight > document.documentElement.clientHeight;
    var scrollbarWidth = hasScrollBar ? getScrollbarWidth() : 0;
    lockStyleRef.current.dataset.id = "td_dialog_".concat(+new Date(), "_").concat(key += 1);
    lockStyleRef.current.innerHTML = "\n      html body {\n        overflow-y: hidden;\n        width: calc(100% - ".concat(scrollbarWidth, "px);\n      }\n    ");
    return clearStyleFunc;
  }, [clearStyleFunc]);
  useIsomorphicLayoutEffect(function () {
    if (typeof document === "undefined") return;
    if (mode !== "modal" || !preventScrollThrough || showInAttachedElement) return;
    if (visible) {
      document.head.appendChild(lockStyleRef.current);
    } else {
      clearStyleFunc();
    }
  }, [preventScrollThrough, visible, mode, showInAttachedElement, clearStyleFunc]);
}

export { useDialogLockStyle as default };
//# sourceMappingURL=useLockStyle.js.map
