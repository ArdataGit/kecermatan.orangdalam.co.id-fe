/**
 * tdesign v1.7.1
 * (c) 2024 tdesign
 * @license MIT
 */

import { _ as _defineProperty } from '../../_chunks/dep-9d06ffd4.js';
import { _ as _slicedToArray } from '../../_chunks/dep-be37289b.js';
import React, { useMemo } from 'react';
import classNames from 'classnames';
import { useLocaleReceiver } from '../../locale/LocalReceiver.js';
import useConfig from '../../hooks/useConfig.js';
import DatePickerCell from './Cell.js';
import { p as parseToDayjs } from '../../_chunks/dep-7fd39d30.js';
import '../../_chunks/dep-e0a22ada.js';
import '../../config-provider/index.js';
import '../../config-provider/ConfigProvider.js';
import '../../_chunks/dep-08fc9b22.js';
import '../../_chunks/dep-f870baf9.js';
import '../../_chunks/dep-1ff7016b.js';
import '../../_chunks/dep-cc3b0635.js';
import '../../_chunks/dep-39d65f32.js';
import '../../_chunks/dep-70de8f55.js';
import '../../_chunks/dep-f3bac8f4.js';
import '../../_chunks/dep-9d4210ce.js';
import '../../_chunks/dep-c2c3c04d.js';
import '../../_chunks/dep-48a2bd8e.js';
import '../../_chunks/dep-8cf947bb.js';
import '../../_chunks/dep-7dbcd8fa.js';
import '../../_chunks/dep-e852e0d4.js';
import '../../_chunks/dep-dc4499f2.js';
import '../../_chunks/dep-213a15b4.js';
import '../../_chunks/dep-43f2594d.js';
import '../../_chunks/dep-dd510963.js';
import '../../_chunks/dep-d8abc91d.js';
import '../../_chunks/dep-17c2aa2b.js';
import '../../_chunks/dep-ab257f91.js';
import '../../_chunks/dep-d4455e7d.js';
import '../../_chunks/dep-42e9f2d1.js';
import '../../_chunks/dep-02fa0b93.js';
import '../../_chunks/dep-24058d76.js';
import '../../config-provider/ConfigContext.js';
import '../../locale/zh_CN.js';
import '../../_common/js/global-config/locale/zh_CN.js';
import '../../_chunks/dep-0f18acb0.js';
import 'dayjs';
import '../../_chunks/dep-8b683475.js';
import '../../_common/js/global-config/default-config.js';
import '../../_chunks/dep-dcdc8bba.js';
import '../../_chunks/dep-06ad19cb.js';
import '../../_chunks/dep-ae7f73fd.js';
import '../../_chunks/dep-b6cd9ebe.js';
import '../../_chunks/dep-c3a67e8f.js';
import '../../_chunks/dep-3f719063.js';
import '../../_common/js/log/index.js';
import '../../_common/js/log/log.js';

function ownKeys(e, r) { var t = Object.keys(e); if (Object.getOwnPropertySymbols) { var o = Object.getOwnPropertySymbols(e); r && (o = o.filter(function (r) { return Object.getOwnPropertyDescriptor(e, r).enumerable; })), t.push.apply(t, o); } return t; }
function _objectSpread(e) { for (var r = 1; r < arguments.length; r++) { var t = null != arguments[r] ? arguments[r] : {}; r % 2 ? ownKeys(Object(t), !0).forEach(function (r) { _defineProperty(e, r, t[r]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(t)) : ownKeys(Object(t)).forEach(function (r) { Object.defineProperty(e, r, Object.getOwnPropertyDescriptor(t, r)); }); } return e; }
var DatePickerTable = function DatePickerTable(props) {
  var _useConfig = useConfig(),
    classPrefix = _useConfig.classPrefix;
  var value = props.value,
    format = props.format,
    mode = props.mode,
    data = props.data,
    time = props.time,
    onCellClick = props.onCellClick,
    onCellMouseEnter = props.onCellMouseEnter,
    onCellMouseLeave = props.onCellMouseLeave,
    firstDayOfWeek = props.firstDayOfWeek;
  var _useLocaleReceiver = useLocaleReceiver("datePicker"),
    _useLocaleReceiver2 = _slicedToArray(_useLocaleReceiver, 2),
    local = _useLocaleReceiver2[0],
    t = _useLocaleReceiver2[1];
  var weekdays = t(local.weekdays);
  var weekAbbreviation = t(local.weekAbbreviation);
  var weekArr = [];
  var wi = firstDayOfWeek - 1;
  var len = weekdays.length;
  while (weekArr.length < len) {
    weekArr.push(weekdays[wi]);
    wi = (wi + len + 1) % len;
  }
  if (mode === "week") weekArr.unshift(weekAbbreviation);
  var showThead = mode === "date" || mode === "week";
  var valueYearWeek = useMemo(function () {
    if (mode !== "week" || !value) return {};
    if (Array.isArray(value)) {
      var _startObj$year, _startObj$locale, _startObj$locale$week, _endObj$year, _endObj$locale, _endObj$locale$week;
      if (!value.length) return {};
      var _value$map = value.map(function (v) {
          return v && parseToDayjs(v, format);
        }),
        _value$map2 = _slicedToArray(_value$map, 2),
        startObj = _value$map2[0],
        endObj = _value$map2[1];
      var startYear = startObj === null || startObj === void 0 || (_startObj$year = startObj.year) === null || _startObj$year === void 0 ? void 0 : _startObj$year.call(startObj);
      var startWeek = startObj === null || startObj === void 0 || (_startObj$locale = startObj.locale) === null || _startObj$locale === void 0 || (_startObj$locale = _startObj$locale.call(startObj, local.dayjsLocale)) === null || _startObj$locale === void 0 || (_startObj$locale$week = _startObj$locale.week) === null || _startObj$locale$week === void 0 ? void 0 : _startObj$locale$week.call(_startObj$locale);
      var endYear = endObj === null || endObj === void 0 || (_endObj$year = endObj.year) === null || _endObj$year === void 0 ? void 0 : _endObj$year.call(endObj);
      var endWeek = endObj === null || endObj === void 0 || (_endObj$locale = endObj.locale) === null || _endObj$locale === void 0 || (_endObj$locale = _endObj$locale.call(endObj, local.dayjsLocale)) === null || _endObj$locale === void 0 || (_endObj$locale$week = _endObj$locale.week) === null || _endObj$locale$week === void 0 ? void 0 : _endObj$locale$week.call(_endObj$locale);
      return {
        startYear: startYear,
        startWeek: startWeek,
        endYear: endYear,
        endWeek: endWeek
      };
    }
    var valueObj = parseToDayjs(value, format).locale(local.dayjsLocale);
    return {
      year: valueObj.year(),
      week: valueObj.week()
    };
  }, [mode, value, format]);
  var weekRowClass = function weekRowClass(value2, targetDayjs) {
    if (mode !== "week" || !value2) return {};
    if (Array.isArray(value2)) {
      if (!value2.length) return {};
      var targetYear = targetDayjs.year();
      var targetWeek = targetDayjs.week();
      var isActive = targetYear === valueYearWeek.startYear && targetWeek === valueYearWeek.startWeek || targetYear === valueYearWeek.endYear && targetWeek === valueYearWeek.endWeek;
      var isRange = targetYear >= valueYearWeek.startYear && targetYear <= valueYearWeek.endYear && targetWeek > valueYearWeek.startWeek && targetWeek < valueYearWeek.endWeek;
      return _defineProperty(_defineProperty({}, "".concat(classPrefix, "-date-picker__table-").concat(mode, "-row--active"), isActive), "".concat(classPrefix, "-date-picker__table-").concat(mode, "-row--range"), isRange);
    }
    return _defineProperty({}, "".concat(classPrefix, "-date-picker__table-").concat(mode, "-row--active"), valueYearWeek.year === targetDayjs.year() && valueYearWeek.week === targetDayjs.week());
  };
  return /* @__PURE__ */React.createElement("div", {
    className: "".concat(classPrefix, "-date-picker__table"),
    onMouseLeave: function onMouseLeave(e) {
      return onCellMouseLeave === null || onCellMouseLeave === void 0 ? void 0 : onCellMouseLeave({
        e: e
      });
    }
  }, /* @__PURE__ */React.createElement("table", null, showThead && /* @__PURE__ */React.createElement("thead", null, /* @__PURE__ */React.createElement("tr", null, weekArr.map(function (value2, i) {
    return /* @__PURE__ */React.createElement("th", {
      key: i
    }, value2);
  }))), /* @__PURE__ */React.createElement("tbody", null, data.map(function (row, i) {
    return /* @__PURE__ */React.createElement("tr", {
      key: i,
      className: classNames("".concat(classPrefix, "-date-picker__table-").concat(mode, "-row"), _objectSpread({}, weekRowClass(value, row[0].dayjsObj)))
    }, row.map(function (col, j) {
      return /* @__PURE__ */React.createElement(DatePickerCell, _objectSpread(_objectSpread({}, col), {}, {
        key: j,
        time: time,
        onClick: onCellClick,
        onMouseEnter: onCellMouseEnter
      }));
    }));
  }))));
};
DatePickerTable.displayName = "DatePickerTable";

export { DatePickerTable as default };
//# sourceMappingURL=Table.js.map
