{"version":3,"file":"index.js","sources":["../../../../src/color-picker/components/panel/index.tsx"],"sourcesContent":["import React, { useEffect, useRef, useState, forwardRef, useCallback } from 'react';\nimport classNames from 'classnames';\nimport tinyColor from 'tinycolor2';\nimport useCommonClassName from '../../../_util/useCommonClassName';\nimport useControlled from '../../../hooks/useControlled';\nimport { useLocaleReceiver } from '../../../locale/LocalReceiver';\nimport useClassName from '../../hooks/useClassNames';\nimport PanelHeader from './header';\nimport Color, { getColorObject } from '../../../_common/js/color-picker/color';\nimport { GradientColorPoint } from '../../../_common/js/color-picker/gradient';\nimport {\n  DEFAULT_COLOR,\n  DEFAULT_LINEAR_GRADIENT,\n  TD_COLOR_USED_COLORS_MAX_SIZE,\n  DEFAULT_SYSTEM_SWATCH_COLORS,\n} from '../../const';\nimport { ColorPickerProps, TdColorModes, TdColorSaturationData } from '../../interface';\nimport { ColorPickerChangeTrigger, TdColorPickerProps } from '../../type';\nimport { colorPickerDefaultProps } from '../../defaultProps';\nimport LinearGradient from './linear-gradient';\nimport SaturationPanel from './saturation';\nimport HUESlider from './hue';\nimport AlphaSlider from './alpha';\nimport FormatPanel from './format';\nimport SwatchesPanel from './swatches';\n\nconst mathRound = Math.round;\n\nconst Panel = forwardRef<HTMLDivElement, ColorPickerProps>((props, ref) => {\n  const baseClassName = useClassName();\n  const { STATUS } = useCommonClassName();\n  const [local, t] = useLocaleReceiver('colorPicker');\n  const {\n    value,\n    disabled,\n    onChange,\n    enableAlpha = false,\n    format,\n    onPaletteBarChange,\n    swatchColors,\n    className,\n    style = {},\n    togglePopup,\n    closeBtn,\n    colorModes = ['linear-gradient', 'monochrome'],\n    showPrimaryColorPreview = true,\n    onRecentColorsChange,\n  } = props;\n  const [innerValue, setInnerValue] = useControlled(props, 'value', onChange);\n  const [mode, setMode] = useState<TdColorModes>(colorModes?.length === 1 ? colorModes[0] : 'monochrome');\n  const [updateId, setUpdateId] = useState(0);\n\n  const isGradient = mode === 'linear-gradient'; // 判断是否为 linear-gradient 模式\n  const defaultEmptyColor = isGradient ? DEFAULT_LINEAR_GRADIENT : DEFAULT_COLOR;\n\n  const [recentlyUsedColors, setRecentlyUsedColors] = useControlled(props, 'recentColors', onRecentColorsChange, {\n    defaultRecentColors: colorPickerDefaultProps.recentColors,\n  });\n\n  const colorInstanceRef = useRef<Color>(new Color(innerValue || defaultEmptyColor));\n  const getModeByColor = colorInstanceRef.current.isGradient ? 'linear-gradient' : 'monochrome';\n  const formatRef = useRef<TdColorPickerProps['format']>(colorInstanceRef.current.isGradient ? 'CSS' : format ?? 'RGB');\n\n  const update = useCallback(\n    (value: string) => {\n      colorInstanceRef.current.update(value);\n      setUpdateId(updateId + 1);\n    },\n    [updateId],\n  );\n\n  const formatValue = useCallback(() => {\n    // 渐变模式下直接输出css样式\n    if (mode === 'linear-gradient') {\n      return colorInstanceRef.current.linearGradient;\n    }\n    const finalFormat = format === 'HEX' && enableAlpha ? 'HEX8' : format; // hex should transfer to hex8 when alpha channel is opened\n    return colorInstanceRef.current.getFormatsColorMap()[finalFormat] || colorInstanceRef.current.css;\n  }, [format, enableAlpha, mode]);\n\n  const emitColorChange = useCallback(\n    (trigger?: ColorPickerChangeTrigger) => {\n      setInnerValue(formatValue(), {\n        color: getColorObject(colorInstanceRef.current),\n        trigger: trigger || 'palette-saturation-brightness',\n      });\n    },\n    [formatValue, setInnerValue],\n  );\n\n  useEffect(() => {\n    if (typeof value === 'undefined' || mode === 'linear-gradient') {\n      return;\n    }\n    // common Color new 的时候使用 hsv ，一个 rgba 可以对应两个 hsv ，这里先直接用 tinycolor 比较下颜色是否修改了\n    const newUniqColor = tinyColor(value).toRgb();\n    const { r, g, b, a } = newUniqColor;\n    const newUniqRgbaColor = `rgba(${mathRound(r)}, ${mathRound(g)}, ${mathRound(b)}, ${a})`;\n\n    const newColor = new Color(value);\n    const formattedColor = newUniqRgbaColor || DEFAULT_COLOR;\n    const currentColor = colorInstanceRef.current.rgba;\n\n    const isInRightMode = mode === 'monochrome' && !newColor.isGradient;\n\n    if (formattedColor !== currentColor && isInRightMode) {\n      update(value);\n      setMode(newColor.isGradient ? 'linear-gradient' : 'monochrome');\n    }\n  }, [value, formatValue, setInnerValue, mode, update]);\n\n  useEffect(() => {\n    if (colorModes.length === 1) {\n      setMode(colorModes[0]);\n    } else {\n      setMode(getModeByColor);\n    }\n  }, [colorModes, getModeByColor]);\n\n  const baseProps = {\n    color: colorInstanceRef.current,\n    disabled,\n    baseClassName,\n  };\n\n  const handleModeChange = (value: TdColorModes) => {\n    setMode(value);\n    const { rgba, gradientColors, linearGradient } = colorInstanceRef.current;\n    if (value === 'linear-gradient') {\n      colorInstanceRef.current = new Color(gradientColors.length > 0 ? linearGradient : DEFAULT_LINEAR_GRADIENT);\n      return;\n    }\n    colorInstanceRef.current = new Color(rgba);\n  };\n  // 最近使用颜色变更时触发\n  const handleRecentlyUsedColorsChange = (colors: string[]) => {\n    setRecentlyUsedColors(colors);\n  };\n\n  // 添加最近使用颜色\n  const addRecentlyUsedColor = () => {\n    const colors = [...((recentlyUsedColors as string[]) || [])];\n    const { isGradient, linearGradient, rgba } = colorInstanceRef.current;\n    const currentColor = isGradient ? linearGradient : rgba;\n    const index = colors.indexOf(currentColor);\n    if (index > -1) {\n      colors.splice(index, 1);\n    }\n    colors.unshift(currentColor);\n    if (colors.length > TD_COLOR_USED_COLORS_MAX_SIZE) {\n      colors.length = TD_COLOR_USED_COLORS_MAX_SIZE;\n    }\n    handleRecentlyUsedColorsChange(colors);\n  };\n\n  // 饱和度变化\n  const handleSaturationChange = ({ saturation, value }: TdColorSaturationData) => {\n    const { saturation: sat, value: val } = colorInstanceRef.current;\n    let changeTrigger: ColorPickerChangeTrigger = 'palette-saturation-brightness';\n    if (value !== val && saturation !== sat) {\n      changeTrigger = 'palette-saturation-brightness';\n      colorInstanceRef.current.saturation = saturation;\n      colorInstanceRef.current.value = value;\n    } else if (saturation !== sat) {\n      changeTrigger = 'palette-saturation';\n      colorInstanceRef.current.saturation = saturation;\n    } else if (value !== val) {\n      changeTrigger = 'palette-brightness';\n      colorInstanceRef.current.value = value;\n    } else {\n      return;\n    }\n\n    emitColorChange(changeTrigger);\n  };\n\n  // hue色相变化\n  const handleHUEChange = (hue: number) => {\n    colorInstanceRef.current.hue = hue;\n    emitColorChange('palette-hue-bar');\n    onPaletteBarChange?.({\n      color: getColorObject(colorInstanceRef.current),\n    });\n  };\n\n  /**\n   * 透明度变化\n   * @param alpha\n   */\n  const handleAlphaChange = (alpha: number) => {\n    colorInstanceRef.current.alpha = alpha;\n    emitColorChange('palette-alpha-bar');\n    onPaletteBarChange?.({\n      color: getColorObject(colorInstanceRef.current),\n    });\n  };\n\n  /**\n   * 渐变改变\n   * @param param0\n   */\n  const handleGradientChange = ({\n    key,\n    payload,\n  }: {\n    key: 'degree' | 'selectedId' | 'colors';\n    payload: number | string | GradientColorPoint[];\n    addUsedColor?: boolean;\n  }) => {\n    let trigger: ColorPickerChangeTrigger = 'palette-saturation-brightness';\n    switch (key) {\n      case 'degree':\n        colorInstanceRef.current.gradientDegree = payload as number;\n        trigger = 'input';\n        break;\n      case 'selectedId':\n        colorInstanceRef.current.gradientSelectedId = payload as string;\n        setUpdateId((prevId) => prevId + 1);\n        break;\n      case 'colors':\n        colorInstanceRef.current.gradientColors = payload as GradientColorPoint[];\n        break;\n    }\n    emitColorChange(trigger);\n  };\n\n  // format选择格式变化\n  const handleFormatModeChange = (format: TdColorPickerProps['format']) => (formatRef.current = format);\n\n  // format输入变化\n  const handleInputChange = (input: string, alpha?: number) => {\n    update(input);\n    colorInstanceRef.current.alpha = alpha;\n    emitColorChange('input');\n  };\n\n  // 渲染预设颜色区域\n  const SwatchesArea = React.memo(() => {\n    // 最近使用颜色\n    const showUsedColors = recentlyUsedColors !== null && recentlyUsedColors !== false;\n    // 系统颜色\n    let systemColors = swatchColors;\n    if (systemColors === undefined) {\n      systemColors = [...DEFAULT_SYSTEM_SWATCH_COLORS];\n    }\n    const showSystemColors = systemColors?.length > 0;\n\n    if (!showSystemColors && !showUsedColors) {\n      return null;\n    }\n\n    // 色块点击\n    const handleSetColor = (value: string, trigger: ColorPickerChangeTrigger) => {\n      const isGradientValue = Color.isGradientColor(value);\n      const color = colorInstanceRef.current;\n      if (isGradientValue) {\n        if (colorModes.includes('linear-gradient')) {\n          setMode('linear-gradient');\n          color.update(value);\n          color.updateCurrentGradientColor();\n        } else {\n          console.warn('linear-gradient is not supported in this mode');\n        }\n      } else if (mode === 'linear-gradient') {\n        setMode('monochrome');\n        color.update(value);\n      } else {\n        color.update(value);\n      }\n      emitColorChange(trigger);\n    };\n\n    return (\n      <>\n        <div className={`${baseClassName}__swatches-wrap`}>\n          {showUsedColors && (\n            <SwatchesPanel\n              {...baseProps}\n              title={t(local.recentColorTitle)}\n              editable\n              handleAddColor={addRecentlyUsedColor}\n              colors={recentlyUsedColors as string[]}\n              onSetColor={(color: string) => handleSetColor(color, 'recent')}\n              onChange={handleRecentlyUsedColorsChange}\n            />\n          )}\n          {showSystemColors && (\n            <SwatchesPanel\n              {...baseProps}\n              title={t(local.swatchColorTitle)}\n              colors={systemColors}\n              onSetColor={(color: string) => handleSetColor(color, 'preset')}\n            />\n          )}\n        </div>\n      </>\n    );\n  });\n\n  return (\n    <div\n      className={classNames(`${baseClassName}__panel`, disabled ? STATUS.disabled : false, className)}\n      onClick={(e) => e.stopPropagation()}\n      style={{ ...style }}\n      ref={ref}\n    >\n      <PanelHeader\n        baseClassName={baseClassName}\n        mode={mode}\n        colorModes={colorModes}\n        closeBtn={closeBtn}\n        togglePopup={togglePopup}\n        onModeChange={handleModeChange}\n      />\n      <div className={`${baseClassName}__body`}>\n        {isGradient && <LinearGradient {...baseProps} onChange={handleGradientChange} />}\n        <SaturationPanel {...baseProps} onChange={handleSaturationChange} />\n        <div className={`${baseClassName}__sliders-wrapper`}>\n          <div className={`${baseClassName}__sliders`}>\n            <HUESlider {...baseProps} onChange={handleHUEChange} />\n            {enableAlpha && <AlphaSlider {...baseProps} onChange={handleAlphaChange} />}\n          </div>\n          {showPrimaryColorPreview ? (\n            <div className={classNames([`${baseClassName}__sliders-preview`, `${baseClassName}--bg-alpha`])}>\n              <span\n                className={`${baseClassName}__sliders-preview-inner`}\n                style={{\n                  background: isGradient ? colorInstanceRef.current.linearGradient : colorInstanceRef.current.rgba,\n                }}\n              />\n            </div>\n          ) : null}\n        </div>\n\n        <FormatPanel\n          {...props}\n          {...baseProps}\n          format={formatRef.current}\n          onModeChange={handleFormatModeChange}\n          onInputChange={handleInputChange}\n        />\n        <SwatchesArea />\n      </div>\n    </div>\n  );\n});\n\nexport default React.memo(Panel);\n"],"names":["mathRound","Math","round","Panel","forwardRef","props","ref","baseClassName","useClassName","_useCommonClassName","useCommonClassName","STATUS","_useLocaleReceiver","useLocaleReceiver","_useLocaleReceiver2","_slicedToArray","local","t","value","disabled","onChange","_props$enableAlpha","enableAlpha","format","onPaletteBarChange","swatchColors","className","_props$style","style","togglePopup","closeBtn","_props$colorModes","colorModes","_props$showPrimaryCol","showPrimaryColorPreview","onRecentColorsChange","_useControlled","useControlled","_useControlled2","innerValue","setInnerValue","_useState","useState","length","_useState2","mode","setMode","_useState3","_useState4","updateId","setUpdateId","isGradient","defaultEmptyColor","DEFAULT_LINEAR_GRADIENT","DEFAULT_COLOR","_useControlled3","defaultRecentColors","colorPickerDefaultProps","recentColors","_useControlled4","recentlyUsedColors","setRecentlyUsedColors","colorInstanceRef","useRef","Color","getModeByColor","current","formatRef","update","useCallback","formatValue","linearGradient","finalFormat","getFormatsColorMap","css","emitColorChange","trigger","color","getColorObject","useEffect","newUniqColor","tinyColor","toRgb","r","g","b","a","newUniqRgbaColor","concat","newColor","formattedColor","currentColor","rgba","isInRightMode","baseProps","handleModeChange","_colorInstanceRef$cur","gradientColors","handleRecentlyUsedColorsChange","colors","addRecentlyUsedColor","_toConsumableArray","_colorInstanceRef$cur2","index","indexOf","splice","unshift","TD_COLOR_USED_COLORS_MAX_SIZE","handleSaturationChange","saturation","_ref","_colorInstanceRef$cur3","sat","val","changeTrigger","handleHUEChange","hue","handleAlphaChange","alpha","handleGradientChange","key","_ref2","payload","gradientDegree","gradientSelectedId","prevId","handleFormatModeChange","handleInputChange","input","SwatchesArea","React","memo","_systemColors","showUsedColors","systemColors","DEFAULT_SYSTEM_SWATCH_COLORS","showSystemColors","handleSetColor","isGradientValue","isGradientColor","includes","updateCurrentGradientColor","console","warn","createElement","SwatchesPanel","_objectSpread","title","recentColorTitle","editable","handleAddColor","onSetColor","swatchColorTitle","classNames","onClick","e","stopPropagation","PanelHeader","onModeChange","LinearGradient","SaturationPanel","HUESlider","AlphaSlider","background","FormatPanel","onInputChange"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA0BA,IAAMA,YAAYC,IAAK,CAAAC,KAAA,CAAA;AAEvB,IAAMC,KAAQ,gBAAAC,UAAA,CAA6C,UAACC,KAAA,EAAOC,GAAQ,EAAA;AACzE,EAAA,IAAMC,gBAAgBC,aAAa,EAAA,CAAA;AAC7B,EAAA,IAAAC,mBAAA,GAAaC,kBAAmB,EAAA;IAA9BC,MAAO,GAAAF,mBAAA,CAAPE,MAAO,CAAA;AACf,EAAA,IAAAC,kBAAA,GAAmBC,kBAAkB,aAAa,CAAA;IAAAC,mBAAA,GAAAC,cAAA,CAAAH,kBAAA,EAAA,CAAA,CAAA;AAA3CI,IAAAA,KAAA,GAAAF,mBAAA,CAAA,CAAA,CAAA;AAAOG,IAAAA,CAAC,GAAAH,mBAAA,CAAA,CAAA,CAAA,CAAA;AACT,EAAA,IACJI,KAAA,GAcEb,KAAA,CAdFa,KAAA;IACAC,QAAA,GAaEd,KAAA,CAbFc,QAAA;IACAC,QAAA,GAYEf,KAAA,CAZFe,QAAA;IAAAC,kBAAA,GAYEhB,KAAA,CAXFiB,WAAc;AAAdA,IAAAA,WAAc,GAAAD,kBAAA,KAAA,KAAA,CAAA,GAAA,KAAA,GAAAA,kBAAA;IACdE,MAAA,GAUElB,KAAA,CAVFkB,MAAA;IACAC,kBAAA,GASEnB,KAAA,CATFmB,kBAAA;IACAC,YAAA,GAQEpB,KAAA,CARFoB,YAAA;IACAC,SAAA,GAOErB,KAAA,CAPFqB,SAAA;IAAAC,YAAA,GAOEtB,KAAA,CANFuB;AAAAA,IAAAA,kCAAQ,EAAC,GAAAD,YAAA;IACTE,WAAA,GAKExB,KAAA,CALFwB,WAAA;IACAC,QAAA,GAIEzB,KAAA,CAJFyB,QAAA;IAAAC,iBAAA,GAIE1B,KAAA,CAHF2B,UAAA;IAAAA,UAAA,GAAAD,iBAAA,KAAa,KAAA,CAAA,GAAA,CAAC,iBAAA,EAAmB,YAAY,CAAA,GAAAA,iBAAA;IAAAE,qBAAA,GAG3C5B,KAAA,CAFF6B,uBAA0B;AAA1BA,IAAAA,uBAA0B,GAAAD,qBAAA,KAAA,KAAA,CAAA,GAAA,IAAA,GAAAA,qBAAA;IAC1BE,oBAAA,GACE9B,KAAA,CADF8B,oBAAA,CAAA;EAEF,IAAAC,cAAA,GAAoCC,aAAc,CAAAhC,KAAA,EAAO,SAASe,QAAQ,CAAA;IAAAkB,eAAA,GAAAvB,cAAA,CAAAqB,cAAA,EAAA,CAAA,CAAA;AAAnEG,IAAAA,UAAY,GAAAD,eAAA,CAAA,CAAA,CAAA;AAAAE,IAAAA,aAAa,GAAAF,eAAA,CAAA,CAAA,CAAA,CAAA;EAC1B,IAAAG,SAAA,GAAkBC,QAAA,CAAuB,CAAAV,uBAAAA,eAAAA,KAAAA,CAAAA,GAAAA,KAAAA,CAAAA,GAAAA,WAAYW,MAAW,MAAA,CAAA,GAAIX,UAAW,CAAA,CAAA,CAAA,GAAK,YAAY,CAAA;IAAAY,UAAA,GAAA7B,cAAA,CAAA0B,SAAA,EAAA,CAAA,CAAA;AAA/FI,IAAAA,IAAM,GAAAD,UAAA,CAAA,CAAA,CAAA;AAAAE,IAAAA,OAAO,GAAAF,UAAA,CAAA,CAAA,CAAA,CAAA;AACpB,EAAA,IAAAG,UAAA,GAAgCL,SAAS,CAAC,CAAA;IAAAM,UAAA,GAAAjC,cAAA,CAAAgC,UAAA,EAAA,CAAA,CAAA;AAAnCE,IAAAA,QAAA,GAAAD,UAAA,CAAA,CAAA,CAAA;AAAUE,IAAAA,WAAW,GAAAF,UAAA,CAAA,CAAA,CAAA,CAAA;AAE5B,EAAA,IAAMG,aAAaN,IAAS,KAAA,iBAAA,CAAA;AACtB,EAAA,IAAAO,iBAAA,GAAoBD,aAAaE,uBAA0B,GAAAC,aAAA,CAAA;EAEjE,IAAAC,eAAA,GAAoDlB,aAAc,CAAAhC,KAAA,EAAO,gBAAgB8B,oBAAsB,EAAA;MAC7GqB,qBAAqBC,uBAAwB,CAAAC,YAAAA;AAC/C,KAAC,CAAA;IAAAC,eAAA,GAAA5C,cAAA,CAAAwC,eAAA,EAAA,CAAA,CAAA;AAFMK,IAAAA,kBAAoB,GAAAD,eAAA,CAAA,CAAA,CAAA;AAAAE,IAAAA,qBAAqB,GAAAF,eAAA,CAAA,CAAA,CAAA,CAAA;EAIhD,IAAMG,mBAAmBC,MAAc,CAAA,IAAIC,KAAM,CAAAzB,UAAA,IAAca,iBAAiB,CAAC,CAAA,CAAA;EACjF,IAAMa,cAAiB,GAAAH,gBAAA,CAAiBI,OAAQ,CAAAf,UAAA,GAAa,iBAAoB,GAAA,YAAA,CAAA;AACjF,EAAA,IAAMgB,YAAYJ,MAAqC,CAAAD,gBAAA,CAAiBI,QAAQf,UAAa,GAAA,KAAA,GAAQ5B,WAAAA,IAAAA,IAAAA,oBAAAA,SAAU,KAAK,CAAA,CAAA;AAEpH,EAAA,IAAM6C,MAAS,GAAAC,WAAA,CACb,UAACnD,MAAkB,EAAA;AACA4C,IAAAA,gBAAA,CAAAI,OAAA,CAAQE,OAAOlD,MAAK,CAAA,CAAA;AACrCgC,IAAAA,WAAA,CAAYD,WAAW,CAAC,CAAA,CAAA;AAC1B,GAAA,EACA,CAACA,QAAQ,CACX,CAAA,CAAA;AAEM,EAAA,IAAAqB,WAAA,GAAcD,YAAY,YAAM;IAEpC,IAAIxB,SAAS,iBAAmB,EAAA;AAC9B,MAAA,OAAOiB,iBAAiBI,OAAQ,CAAAK,cAAA,CAAA;AAClC,KAAA;IACA,IAAMC,WAAc,GAAAjD,MAAA,KAAW,KAAS,IAAAD,WAAA,GAAc,MAAS,GAAAC,MAAA,CAAA;AAC/D,IAAA,OAAOuC,iBAAiBI,OAAQ,CAAAO,kBAAA,EAAqB,CAAAD,WAAA,CAAA,IAAgBV,iBAAiBI,OAAQ,CAAAQ,GAAA,CAAA;GAC7F,EAAA,CAACnD,MAAQ,EAAAD,WAAA,EAAauB,IAAI,CAAC,CAAA,CAAA;AAE9B,EAAA,IAAM8B,eAAkB,GAAAN,WAAA,CACtB,UAACO,OAAuC,EAAA;AACtCpC,IAAAA,aAAA,CAAc8B,aAAe,EAAA;AAC3BO,MAAAA,KAAA,EAAOC,cAAe,CAAAhB,gBAAA,CAAiBI,OAAO,CAAA;MAC9CU,SAASA,OAAW,IAAA,+BAAA;AACtB,KAAC,CAAA,CAAA;AACH,GAAA,EACA,CAACN,aAAa9B,aAAa,CAC7B,CAAA,CAAA;AAEAuC,EAAAA,SAAA,CAAU,YAAM;IACd,IAAI,OAAO7D,KAAA,KAAU,WAAe,IAAA2B,IAAA,KAAS,iBAAmB,EAAA;AAC9D,MAAA,OAAA;AACF,KAAA;IAEA,IAAMmC,YAAe,GAAAC,SAAA,CAAU/D,KAAK,CAAA,CAAEgE,KAAM,EAAA,CAAA;AAC5C,IAAA,IAAQC,CAAA,GAAeH,YAAA,CAAfG,CAAA;MAAGC,CAAG,GAASJ,YAAA,CAAZI,CAAG;MAAAC,CAAA,GAASL,YAAA,CAATK,CAAA;MAAGC,IAAMN,YAAA,CAANM;IACX,IAAAC,gBAAA,GAAAC,OAAAA,CAAAA,MAAA,CAA2BxF,SAAA,CAAUmF,CAAC,CAAA,EAAA,IAAA,CAAA,CAAAK,MAAA,CAAMxF,UAAUoF,CAAC,CAAA,EAAA,IAAA,CAAA,CAAAI,MAAA,CAAMxF,SAAU,CAAAqF,CAAC,CAAM,EAAAG,IAAAA,CAAAA,CAAAA,MAAA,CAAAF,CAAA,EAAA,GAAA,CAAA,CAAA;AAE9E,IAAA,IAAAG,QAAA,GAAW,IAAIzB,KAAA,CAAM9C,KAAK,CAAA,CAAA;AAChC,IAAA,IAAMwE,iBAAiBH,gBAAoB,IAAAjC,aAAA,CAAA;AACrC,IAAA,IAAAqC,YAAA,GAAe7B,iBAAiBI,OAAQ,CAAA0B,IAAA,CAAA;IAE9C,IAAMC,aAAgB,GAAAhD,IAAA,KAAS,YAAgB,IAAA,CAAC4C,QAAS,CAAAtC,UAAA,CAAA;AAErD,IAAA,IAAAuC,cAAA,KAAmBC,gBAAgBE,aAAe,EAAA;MACpDzB,MAAA,CAAOlD,KAAK,CAAA,CAAA;MACJ4B,OAAA,CAAA2C,QAAA,CAAStC,UAAa,GAAA,iBAAA,GAAoB,YAAY,CAAA,CAAA;AAChE,KAAA;AACF,KAAG,CAACjC,KAAA,EAAOoD,aAAa9B,aAAe,EAAAK,IAAA,EAAMuB,MAAM,CAAC,CAAA,CAAA;AAEpDW,EAAAA,SAAA,CAAU,YAAM;AACV,IAAA,IAAA/C,UAAA,CAAWW,WAAW,CAAG,EAAA;AAC3BG,MAAAA,OAAA,CAAQd,WAAW,CAAE,CAAA,CAAA,CAAA;AACvB,KAAO,MAAA;MACLc,OAAA,CAAQmB,cAAc,CAAA,CAAA;AACxB,KAAA;AACF,GAAG,EAAA,CAACjC,UAAY,EAAAiC,cAAc,CAAC,CAAA,CAAA;AAE/B,EAAA,IAAM6B,SAAY,GAAA;IAChBjB,OAAOf,gBAAiB,CAAAI,OAAA;AACxB/C,IAAAA,QAAA,EAAAA,QAAA;AACAZ,IAAAA,aAAA,EAAAA,aAAAA;GACF,CAAA;AAEM,EAAA,IAAAwF,gBAAA,GAAmB,SAAnBA,gBAAAA,CAAoB7E,MAAwB,EAAA;IAChD4B,OAAA,CAAQ5B,MAAK,CAAA,CAAA;AACb,IAAA,IAAA8E,qBAAA,GAAiDlC,gBAAiB,CAAAI,OAAA;MAA1D0B,IAAA,GAAAI,qBAAA,CAAAJ,IAAA;MAAMK,cAAgB,GAAAD,qBAAA,CAAhBC,cAAgB;MAAA1B,cAAA,GAAAyB,qBAAA,CAAAzB,cAAA,CAAA;IAC9B,IAAIrD,WAAU,iBAAmB,EAAA;AAC/B4C,MAAAA,gBAAA,CAAiBI,UAAU,IAAIF,KAAA,CAAMiC,eAAetD,MAAS,GAAA,CAAA,GAAI4B,iBAAiBlB,uBAAuB,CAAA,CAAA;AACzG,MAAA,OAAA;AACF,KAAA;AACiBS,IAAAA,gBAAA,CAAAI,OAAA,GAAU,IAAIF,KAAA,CAAM4B,IAAI,CAAA,CAAA;GAC3C,CAAA;AAEM,EAAA,IAAAM,8BAAA,GAAiC,SAAjCA,8BAAAA,CAAkCC,MAAqB,EAAA;IAC3DtC,qBAAA,CAAsBsC,MAAM,CAAA,CAAA;GAC9B,CAAA;AAGA,EAAA,IAAMC,uBAAuB,SAAvBA,uBAA6B;AACjC,IAAA,IAAMD,MAAS,GAAAE,kBAAA,CAAMzC,kBAAA,IAAmC,EAAG,CAAA,CAAA;AAC3D,IAAA,IAAA0C,sBAAA,GAA6CxC,gBAAiB,CAAAI,OAAA;MAAtDf,WAAAA,GAAAA,sBAAAA,CAAAA,UAAAA;MAAYoB,cAAgB,GAAA+B,sBAAA,CAAhB/B,cAAgB;MAAAqB,IAAA,GAAAU,sBAAA,CAAAV,IAAA,CAAA;AAC9B,IAAA,IAAAD,YAAA,GAAexC,cAAaoB,cAAiB,GAAAqB,IAAA,CAAA;AAC7C,IAAA,IAAAW,KAAA,GAAQJ,MAAO,CAAAK,OAAA,CAAQb,YAAY,CAAA,CAAA;AACzC,IAAA,IAAIY,QAAQ,CAAI,CAAA,EAAA;AACPJ,MAAAA,MAAA,CAAAM,MAAA,CAAOF,OAAO,CAAC,CAAA,CAAA;AACxB,KAAA;AACAJ,IAAAA,MAAA,CAAOO,QAAQf,YAAY,CAAA,CAAA;AACvB,IAAA,IAAAQ,MAAA,CAAOxD,SAASgE,6BAA+B,EAAA;MACjDR,MAAA,CAAOxD,MAAS,GAAAgE,6BAAA,CAAA;AAClB,KAAA;IACAT,8BAAA,CAA+BC,MAAM,CAAA,CAAA;GACvC,CAAA;AAGA,EAAA,IAAMS,yBAAyB,SAAzBA,6BAA2E;AAAA,IAAA,IAA/CC,UAAY,GAAAC,IAAA,CAAZD,UAAY;MAAA3F,cAAAA,KAAA,CAAA;AAC5C,IAAA,IAAA6F,sBAAA,GAAwCjD,gBAAiB,CAAAI,OAAA;MAArC8C,GAAA,GAAAD,sBAAA,CAAZF,UAAY;MAAYI,GAAA,GAAAF,sBAAA,CAAP7F,KAAO,CAAA;IAChC,IAAIgG,aAA0C,GAAA,+BAAA,CAAA;AAC1ChG,IAAAA,IAAAA,MAAAA,KAAU+F,GAAO,IAAAJ,UAAA,KAAeG,GAAK,EAAA;AACvBE,MAAAA,aAAA,GAAA,+BAAA,CAAA;AAChBpD,MAAAA,gBAAA,CAAiBI,QAAQ2C,UAAa,GAAAA,UAAA,CAAA;AACtC/C,MAAAA,gBAAA,CAAiBI,QAAQhD,KAAQA,GAAAA,MAAAA,CAAAA;AACnC,KAAA,MAAA,IAAW2F,eAAeG,GAAK,EAAA;AACbE,MAAAA,aAAA,GAAA,oBAAA,CAAA;AAChBpD,MAAAA,gBAAA,CAAiBI,QAAQ2C,UAAa,GAAAA,UAAA,CAAA;AACxC,KAAA,MAAA,IAAW3F,WAAU+F,GAAK,EAAA;AACRC,MAAAA,aAAA,GAAA,oBAAA,CAAA;AAChBpD,MAAAA,gBAAA,CAAiBI,QAAQhD,KAAQA,GAAAA,MAAAA,CAAAA;AACnC,KAAO,MAAA;AACL,MAAA,OAAA;AACF,KAAA;IAEAyD,eAAA,CAAgBuC,aAAa,CAAA,CAAA;GAC/B,CAAA;AAGM,EAAA,IAAAC,eAAA,GAAkB,SAAlBA,eAAAA,CAAmBC,GAAgB,EAAA;AACvCtD,IAAAA,gBAAA,CAAiBI,QAAQkD,GAAM,GAAAA,GAAA,CAAA;IAC/BzC,eAAA,CAAgB,iBAAiB,CAAA,CAAA;AACZnD,IAAAA,kBAAA,KAAAA,IAAAA,IAAAA,kBAAA,KAAAA,KAAAA,CAAAA,IAAAA,kBAAA,CAAA;AACnBqD,MAAAA,KAAA,EAAOC,cAAe,CAAAhB,gBAAA,CAAiBI,OAAO,CAAA;AAChD,KAAC,CAAA,CAAA;GACH,CAAA;AAMM,EAAA,IAAAmD,iBAAA,GAAoB,SAApBA,iBAAAA,CAAqBC,KAAkB,EAAA;AAC3CxD,IAAAA,gBAAA,CAAiBI,QAAQoD,KAAQ,GAAAA,KAAA,CAAA;IACjC3C,eAAA,CAAgB,mBAAmB,CAAA,CAAA;AACdnD,IAAAA,kBAAA,KAAAA,IAAAA,IAAAA,kBAAA,KAAAA,KAAAA,CAAAA,IAAAA,kBAAA,CAAA;AACnBqD,MAAAA,KAAA,EAAOC,cAAe,CAAAhB,gBAAA,CAAiBI,OAAO,CAAA;AAChD,KAAC,CAAA,CAAA;GACH,CAAA;AAMA,EAAA,IAAMqD,uBAAuB,SAAvBA,4BAOA;AAAA,IAAA,IANJC,GAAA,GAAAC,KAAA,CAAAD,GAAA;MACAE,OAAA,GAAAD,KAAA,CAAAC,OAAA,CAAA;IAMA,IAAI9C,OAAoC,GAAA,+BAAA,CAAA;AAChC,IAAA,QAAA4C,GAAA;AACD,MAAA,KAAA,QAAA;AACH1D,QAAAA,gBAAA,CAAiBI,QAAQyD,cAAiB,GAAAD,OAAA,CAAA;AAChC9C,QAAAA,OAAA,GAAA,OAAA,CAAA;AACV,QAAA,MAAA;AACG,MAAA,KAAA,YAAA;AACHd,QAAAA,gBAAA,CAAiBI,QAAQ0D,kBAAqB,GAAAF,OAAA,CAAA;QAClCxE,WAAA,CAAA,UAAC2E,MAAW,EAAA;UAAA,OAAAA,MAAA,GAAS,CAAC,CAAA;SAAA,CAAA,CAAA;AAClC,QAAA,MAAA;AACG,MAAA,KAAA,QAAA;AACH/D,QAAAA,gBAAA,CAAiBI,QAAQ+B,cAAiB,GAAAyB,OAAA,CAAA;AAC1C,QAAA,MAAA;AAAA,KAAA;IAEJ/C,eAAA,CAAgBC,OAAO,CAAA,CAAA;GACzB,CAAA;AAGA,EAAA,IAAMkD,sBAAyB,GAAA,SAAzBA,sBAAyBA,CAACvG,OAA0C,EAAA;AAAA,IAAA,OAAA4C,SAAA,CAAUD,OAAU3C,GAAAA,OAAAA,CAAAA;AAAAA,GAAAA,CAAAA;EAGxF,IAAAwG,iBAAA,GAAoB,SAApBA,iBAAAA,CAAqBC,KAAA,EAAeV,KAAmB,EAAA;IAC3DlD,MAAA,CAAO4D,KAAK,CAAA,CAAA;AACZlE,IAAAA,gBAAA,CAAiBI,QAAQoD,KAAQ,GAAAA,KAAA,CAAA;IACjC3C,eAAA,CAAgB,OAAO,CAAA,CAAA;GACzB,CAAA;AAGM,EAAA,IAAAsD,YAAA,gBAAeC,KAAM,CAAAC,IAAA,CAAK,YAAM;AAAA,IAAA,IAAAC,aAAA,CAAA;IAE9B,IAAAC,cAAA,GAAiBzE,kBAAuB,KAAA,IAAA,IAAQA,kBAAuB,KAAA,KAAA,CAAA;IAE7E,IAAI0E,YAAe,GAAA7G,YAAA,CAAA;AACnB,IAAA,IAAI6G,iBAAiB,KAAW,CAAA,EAAA;AACfA,MAAAA,YAAA,GAAAjC,kBAAA,CAAIkC,4BAA4B,CAAA,CAAA;AACjD,KAAA;AACM,IAAA,IAAAC,gBAAA,GAAmB,CAAAJ,CAAAA,aAAA,GAAAE,4CAAAF,KAAAA,CAAAA,GAAAA,KAAAA,CAAAA,GAAAA,aAAA,CAAczF,MAAS,IAAA,CAAA,CAAA;AAE5C,IAAA,IAAA,CAAC6F,gBAAoB,IAAA,CAACH,cAAgB,EAAA;AACjC,MAAA,OAAA,IAAA,CAAA;AACT,KAAA;IAGM,IAAAI,cAAA,GAAiB,SAAjBA,cAAAA,CAAkBvH,MAAAA,EAAe0D,OAAsC,EAAA;AACrE,MAAA,IAAA8D,eAAA,GAAkB1E,KAAM,CAAA2E,eAAA,CAAgBzH,MAAK,CAAA,CAAA;AACnD,MAAA,IAAM2D,QAAQf,gBAAiB,CAAAI,OAAA,CAAA;AAC/B,MAAA,IAAIwE,eAAiB,EAAA;AACf,QAAA,IAAA1G,UAAA,CAAW4G,QAAS,CAAA,iBAAiB,CAAG,EAAA;UAC1C9F,OAAA,CAAQ,iBAAiB,CAAA,CAAA;AACzB+B,UAAAA,KAAA,CAAMT,OAAOlD,MAAK,CAAA,CAAA;UAClB2D,KAAA,CAAMgE,0BAA2B,EAAA,CAAA;AACnC,SAAO,MAAA;AACLC,UAAAA,OAAA,CAAQC,KAAK,+CAA+C,CAAA,CAAA;AAC9D,SAAA;AACF,OAAA,MAAA,IAAWlG,SAAS,iBAAmB,EAAA;QACrCC,OAAA,CAAQ,YAAY,CAAA,CAAA;AACpB+B,QAAAA,KAAA,CAAMT,OAAOlD,MAAK,CAAA,CAAA;AACpB,OAAO,MAAA;AACL2D,QAAAA,KAAA,CAAMT,OAAOlD,MAAK,CAAA,CAAA;AACpB,OAAA;MACAyD,eAAA,CAAgBC,OAAO,CAAA,CAAA;KACzB,CAAA;AAEA,IAAA,+EAEKsD,KAAA,CAAAc,aAAA,CAAA,KAAA,EAAA;MAAItH,qBAAcnB,aAAA,EAAA,iBAAA,CAAA;AAAA,KAAA,EAChB8H,iCACEH,KAAA,CAAAc,aAAA,CAAAC,aAAA,EAAAC,aAAA,CAAAA,aAAA,KACKpD,SAAA,CAAA,EAAA,EAAA,EAAA;AACJqD,MAAAA,KAAA,EAAOlI,CAAE,CAAAD,KAAA,CAAMoI,gBAAgB,CAAA;AAC/BC,MAAAA,QAAQ,EAAA,IAAA;AACRC,MAAAA,cAAgB,EAAAlD,oBAAA;AAChBD,MAAAA,MAAQ,EAAAvC,kBAAA;MACR2F,UAAY,EAAA,SAAAA,UAAAA,CAAC1E,KAAkB,EAAA;AAAA,QAAA,OAAA4D,cAAA,CAAe5D,OAAO,QAAQ,CAAA,CAAA;AAAA,OAAA;AAC7DzD,MAAAA,QAAU,EAAA8E,8BAAAA;AAAA,KAAA,CACZ,CAAA,EAEDsC,mCACEN,KAAA,CAAAc,aAAA,CAAAC,aAAA,EAAAC,aAAA,CAAAA,aAAA,KACKpD,SAAA,CAAA,EAAA,EAAA,EAAA;AACJqD,MAAAA,KAAA,EAAOlI,CAAE,CAAAD,KAAA,CAAMwI,gBAAgB,CAAA;AAC/BrD,MAAAA,MAAQ,EAAAmC,YAAA;MACRiB,UAAY,EAAA,SAAAA,UAAAA,CAAC1E,KAAkB,EAAA;AAAA,QAAA,OAAA4D,cAAA,CAAe5D,OAAO,QAAQ,CAAA,CAAA;AAAA,OAAA;KAC/D,CAAA,CAEJ,CACF,CAAA,CAAA;AAEJ,GAAC,CAAA,CAAA;AAED,EAAA,sBACGqD,KAAA,CAAAc,aAAA,CAAA,KAAA,EAAA;AACCtH,IAAAA,SAAA,EAAW+H,qBAAclJ,aAAA,EAAwBY,SAAAA,CAAAA,EAAAA,WAAWR,MAAO,CAAAQ,QAAA,GAAW,OAAOO,SAAS,CAAA;IAC9FgI,OAAS,EAAA,SAAAA,OAAAA,CAACC,CAAM,EAAA;AAAA,MAAA,OAAAA,CAAA,CAAEC,eAAgB,EAAA,CAAA;AAAA,KAAA;AAClChI,IAAAA,KAAA,EAAAsH,aAAA,CAAYtH,EAAAA,EAAAA,KAAM,CAAA;AAClBtB,IAAAA,GAAA,EAAAA,GAAAA;AAAA,GAAA,iBAEC4H,KAAA,CAAAc,aAAA,CAAAa,WAAA,EAAA;AACCtJ,IAAAA,aAAA,EAAAA,aAAA;AACAsC,IAAAA,IAAA,EAAAA,IAAA;AACAb,IAAAA,UAAA,EAAAA,UAAA;AACAF,IAAAA,QAAA,EAAAA,QAAA;AACAD,IAAAA,WAAA,EAAAA,WAAA;AACAiI,IAAAA,YAAc,EAAA/D,gBAAAA;GAChB,kBACCmC,KAAA,CAAAc,aAAA,CAAA,KAAA,EAAA;IAAItH,qBAAcnB,aAAA,EAAA,QAAA,CAAA;AAAA,GAAA,EAChB4C,6BAAe+E,KAAA,CAAAc,aAAA,CAAAe,cAAA,EAAAb,aAAA,CAAAA,aAAA,KAAmBpD,SAAA,CAAA,EAAA,EAAA,EAAA;AAAW1E,IAAAA,QAAU,EAAAmG,oBAAAA;AAAA,GAAA,CAAsB,kBAC7EW,KAAA,CAAAc,aAAA,CAAAgB,eAAA,EAAAd,aAAA,CAAAA,aAAA,KAAoBpD,SAAA,CAAA,EAAA,EAAA,EAAA;AAAW1E,IAAAA,QAAU,EAAAwF,sBAAAA;GAAwB,CAAA,kBACjEsB,KAAA,CAAAc,aAAA,CAAA,KAAA,EAAA;IAAItH,qBAAcnB,aAAA,EAAA,mBAAA,CAAA;AAAA,GAAA,iBAChB2H,KAAA,CAAAc,aAAA,CAAA,KAAA,EAAA;IAAItH,qBAAcnB,aAAA,EAAA,WAAA,CAAA;AAAA,GAAA,iBAChB2H,KAAA,CAAAc,aAAA,CAAAiB,SAAA,EAAAf,aAAA,CAAAA,aAAA,CAAA,EAAA,EAAcpD,SAAA,CAAA,EAAA,EAAA,EAAA;AAAW1E,IAAAA,QAAU,EAAA+F,eAAAA;AAAA,GAAA,CAAiB,CAAA,EACpD7F,8BAAgB4G,KAAA,CAAAc,aAAA,CAAAkB,WAAA,EAAAhB,aAAA,CAAAA,aAAA,KAAgBpD,SAAA,CAAA,EAAA,EAAA,EAAA;AAAW1E,IAAAA,QAAU,EAAAiG,iBAAAA;GAAmB,CAAA,CAC3E,CACC,EAAAnF,uBAAA,kBACEgG,KAAA,CAAAc,aAAA,CAAA,KAAA,EAAA;IAAItH,WAAW+H,UAAW,CAAA,CAAAjE,EAAAA,CAAAA,MAAA,CAAIjF,aAAkC,EAAAiF,mBAAAA,CAAAA,EAAAA,EAAAA,CAAAA,MAAA,CAAGjF,eAA0B,YAAA,CAAA,CAAA,CAAA;AAAA,GAAA,iBAC3F2H,KAAA,CAAAc,aAAA,CAAA,MAAA,EAAA;AACCtH,IAAAA,qBAAcnB,aAAA,EAAA,yBAAA,CAAA;AACdqB,IAAAA,KAAO,EAAA;AACLuI,MAAAA,YAAYhH,UAAa,GAAAW,gBAAA,CAAiBI,OAAQ,CAAAK,cAAA,GAAiBT,iBAAiBI,OAAQ,CAAA0B,IAAAA;AAC9F,KAAA;GACF,CACF,CAAA,GACE,IACN,CAAA,iBAECsC,KAAA,CAAAc,aAAA,CAAAoB,WAAA,EAAAlB,aAAA,CAAAA,aAAA,CAAAA,aAAA,CAAA,EAAA,EACK7I,KAAA,CAAA,EACAyF,SAAA,CAAA,EAAA,EAAA,EAAA;IACJvE,QAAQ4C,SAAU,CAAAD,OAAA;AAClB4F,IAAAA,YAAc,EAAAhC,sBAAA;AACduC,IAAAA,aAAe,EAAAtC,iBAAAA;AAAA,GAAA,CACjB,CACA,iBAAAG,KAAA,CAAAc,aAAA,CAACf,YAAa,EAAA,IAAA,CAChB,CACF,CAAA,CAAA;AAEJ,CAAC,CAAA,CAAA;AAED,iBAAA,aAAeC,KAAA,CAAMC,KAAKhI,KAAK,CAAA;;;;"}