{"version":3,"file":"Descriptions.js","sources":["../../node_modules/lodash/assign.js","../../src/descriptions/Descriptions.tsx"],"sourcesContent":["var assignValue = require('./_assignValue'),\n    copyObject = require('./_copyObject'),\n    createAssigner = require('./_createAssigner'),\n    isArrayLike = require('./isArrayLike'),\n    isPrototype = require('./_isPrototype'),\n    keys = require('./keys');\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Assigns own enumerable string keyed properties of source objects to the\n * destination object. Source objects are applied from left to right.\n * Subsequent sources overwrite property assignments of previous sources.\n *\n * **Note:** This method mutates `object` and is loosely based on\n * [`Object.assign`](https://mdn.io/Object/assign).\n *\n * @static\n * @memberOf _\n * @since 0.10.0\n * @category Object\n * @param {Object} object The destination object.\n * @param {...Object} [sources] The source objects.\n * @returns {Object} Returns `object`.\n * @see _.assignIn\n * @example\n *\n * function Foo() {\n *   this.a = 1;\n * }\n *\n * function Bar() {\n *   this.c = 3;\n * }\n *\n * Foo.prototype.b = 2;\n * Bar.prototype.d = 4;\n *\n * _.assign({ 'a': 0 }, new Foo, new Bar);\n * // => { 'a': 1, 'c': 3 }\n */\nvar assign = createAssigner(function(object, source) {\n  if (isPrototype(source) || isArrayLike(source)) {\n    copyObject(source, keys(source), object);\n    return;\n  }\n  for (var key in source) {\n    if (hasOwnProperty.call(source, key)) {\n      assignValue(object, key, source[key]);\n    }\n  }\n});\n\nmodule.exports = assign;\n","import React from 'react';\nimport classNames from 'classnames';\nimport isArray from 'lodash/isArray';\nimport assign from 'lodash/assign';\nimport { TdDescriptionItemProps, TdDescriptionsProps } from './type';\nimport { descriptionItemDefaultProps, descriptionsDefaultProps } from './defaultProps';\nimport useDefaultProps from '../hooks/useDefaultProps';\nimport useConfig from '../hooks/useConfig';\nimport useCommonClassName from '../hooks/useCommonClassName';\nimport { LayoutEnum, StyledProps } from '../common';\nimport { DescriptionsContext } from './DescriptionsContext';\nimport DescriptionsItem from './DescriptionsItem';\nimport Row from './Row';\n\n/**\n * 实现思路\n * 1. 基于 table tbody tr td 来实现布局\n * 2. 通过 span 计算总共有几行以及每一行的 item 个数，特别注意最后一行，要填充满\n * 3. 整体布局：左右布局（column 和 span 生效）/上下布局（column 和 span 失效，一行一个 item）\n * 4. item 布局：左右布局/上下布局\n */\n\n/**\n * TDescriptions：承载 header（title） 和 body（table, tbody）\n * TDescriptionsRow：承载每一行（tr）\n * TDescriptionsItem：获取 item 数据（span, label, content）\n */\n\nexport type DescriptionsProps = TdDescriptionsProps &\n  StyledProps & {\n    children?: React.ReactNode;\n  };\n\nconst Descriptions = (DescriptionsProps: DescriptionsProps) => {\n  const props = useDefaultProps<DescriptionsProps>(DescriptionsProps, descriptionsDefaultProps);\n\n  const { className, style, title, bordered, column, layout, items: rowItems, children } = props;\n\n  const { classPrefix } = useConfig();\n\n  const COMPONENT_NAME = `${classPrefix}-descriptions`;\n\n  const { SIZE } = useCommonClassName();\n\n  // 计算渲染的行内容\n  const getRows = () => {\n    // 1. 两种方式：a. props 传 items b. slots t-descriptions-item; a 优先级更高\n\n    let items: TdDescriptionItemProps[] = [];\n\n    if (isArray(rowItems)) {\n      /**\n       * 2.1 a 方式获取 items\n       * ! 这里要支持 label: string / <div></div> / () =>  <div></div>\n       * ! 暂时没有这样一个全局的方法，所以先在组件内部写一个临时方法，无论之后是有了更好的处理方式要删除掉，还是其它组件也需要时再放到公共方法里面，都是可行的\n       */\n      items = rowItems.map((item) => {\n        const { span } = assign({}, descriptionItemDefaultProps, item);\n        return {\n          label: item.label,\n          content: item.content,\n          span,\n        };\n      });\n    } else {\n      // 2.2 b 方式 获取 TDescriptionsItem\n      const childrenList = React.Children.toArray(children).filter(\n        (child: JSX.Element) => child.type.displayName === DescriptionsItem.displayName,\n      );\n\n      if (childrenList.length !== 0) {\n        items = (childrenList as React.ReactElement[]).map(({ props: child }) => {\n          const { span } = assign({}, descriptionItemDefaultProps, child);\n\n          return {\n            label: child.label,\n            content: child.content ?? child.children,\n            span,\n          };\n        });\n      }\n    }\n\n    // 2. 判断布局，如果整体布局为 LayoutEnum.VERTICAL，那么直接返回即可。\n    if (layout === LayoutEnum.VERTICAL) {\n      return [items];\n    }\n    // 3. 布局为 LayoutEnum.HORIZONTAL 时，需要计算每一行的 item 个数\n    let temp: TdDescriptionItemProps[] = [];\n    let reset = column;\n    // 4. 记录结果\n    const res: TdDescriptionItemProps[][] = [];\n    items.forEach((item, index) => {\n      const { span } = item;\n      if (reset >= span) {\n        // 当前行还剩余空间\n        temp.push(item);\n        reset -= span;\n      } else {\n        // 当前行放不下了，放下一行\n        res.push(temp);\n        temp = [item];\n        reset = column - span;\n      }\n\n      if (index === items.length - 1) {\n        // 最后一个\n        Reflect.set(item, 'span', span + reset);\n        res.push(temp);\n      }\n    });\n\n    return res;\n  };\n\n  // Header\n  const renderHeader = () => (title ? <div className={`${COMPONENT_NAME}__header`}>{title}</div> : '');\n\n  // Body\n  const renderBody = () => {\n    const tableClass = [`${COMPONENT_NAME}__body`, SIZE[props.size], { [`${COMPONENT_NAME}__body--border`]: bordered }];\n    return (\n      <table className={classNames(tableClass)}>\n        <tbody>\n          {getRows().map((row, i) => (\n            <Row row={row} key={i} />\n          ))}\n        </tbody>\n      </table>\n    );\n  };\n\n  return (\n    <DescriptionsContext.Provider value={props}>\n      <div className={classNames(className, COMPONENT_NAME)} style={style}>\n        {renderHeader()}\n        {renderBody()}\n      </div>\n    </DescriptionsContext.Provider>\n  );\n};\n\nDescriptions.displayName = 'Descriptions';\n\nDescriptions.DescriptionsItem = DescriptionsItem;\n\nexport default Descriptions;\n"],"names":["assignValue","require$$0","copyObject","require$$1","createAssigner","require$$2","isArrayLike","require$$3","isPrototype","require$$4","keys","require$$5","objectProto","Object","prototype","hasOwnProperty","assign","object","source","key","call","assign_1","Descriptions","DescriptionsProps","props","useDefaultProps","descriptionsDefaultProps","className","style","title","bordered","column","layout","rowItems","items","children","_useConfig","useConfig","classPrefix","COMPONENT_NAME","_useCommonClassName","useCommonClassName","SIZE","getRows","isArray","map","item","_assign","descriptionItemDefaultProps","span","label","content","childrenList","React","Children","toArray","filter","child","type","displayName","DescriptionsItem","length","_ref","_child$content","_assign2","LayoutEnum","VERTICAL","temp","reset","res","forEach","index","push","Reflect","set","renderHeader","createElement","renderBody","tableClass","concat","size","_defineProperty","classNames","row","i","Row","DescriptionsContext","Provider","value"],"mappings":"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"}