/**
 * tdesign v1.7.1
 * (c) 2024 tdesign
 * @license MIT
 */

'use strict';

Object.defineProperty(exports, '__esModule', { value: true });

var defineProperty = require('../../_chunks/dep-ff9a5a06.js');
var slicedToArray = require('../../_chunks/dep-c86b4e2f.js');
var React = require('react');
var classNames = require('classnames');
var locale_LocalReceiver = require('../../locale/LocalReceiver.js');
var hooks_useConfig = require('../../hooks/useConfig.js');
var datePicker_base_Cell = require('./Cell.js');
var _common_js_datePicker_format = require('../../_chunks/dep-5bc79ae0.js');
require('../../_chunks/dep-2e4b81d6.js');
require('../../config-provider/ConfigContext.js');
require('../../_chunks/dep-be14ef0c.js');
require('../../_chunks/dep-d9f1fc69.js');
require('../../_chunks/dep-4a411278.js');
require('../../_chunks/dep-9171afa5.js');
require('../../_chunks/dep-7d38d5e1.js');
require('../../_chunks/dep-a4fb1294.js');
require('../../_chunks/dep-68d6ca4f.js');
require('../../_chunks/dep-59101a1c.js');
require('../../_chunks/dep-5ed3b3ae.js');
require('../../_chunks/dep-8bb91473.js');
require('../../_chunks/dep-2caefa8e.js');
require('../../_chunks/dep-3076c3e7.js');
require('../../_chunks/dep-315a4a2b.js');
require('../../_chunks/dep-14dd074a.js');
require('../../_chunks/dep-d93c04ca.js');
require('../../_chunks/dep-2a8c4619.js');
require('../../_chunks/dep-1c485dd2.js');
require('../../_chunks/dep-e7a0e8b4.js');
require('../../_chunks/dep-6bae679a.js');
require('../../_chunks/dep-b54caa56.js');
require('../../_chunks/dep-33b4bb35.js');
require('../../_chunks/dep-bd15ffce.js');
require('../../_chunks/dep-7b996f28.js');
require('../../_common/js/global-config/locale/zh_CN.js');
require('../../_chunks/dep-a4ac3164.js');
require('dayjs');
require('../../_common/js/global-config/default-config.js');
require('../../_chunks/dep-c18c81f4.js');
require('../../_chunks/dep-174c24e3.js');
require('../../_chunks/dep-65db251c.js');
require('../../_chunks/dep-6b656ad5.js');
require('../../_chunks/dep-f70c56e2.js');
require('../../_chunks/dep-ed73cb23.js');
require('../../_common/js/log/log.js');

function _interopDefaultLegacy (e) { return e && typeof e === 'object' && 'default' in e ? e : { 'default': e }; }

var React__default = /*#__PURE__*/_interopDefaultLegacy(React);
var classNames__default = /*#__PURE__*/_interopDefaultLegacy(classNames);

function ownKeys(e, r) { var t = Object.keys(e); if (Object.getOwnPropertySymbols) { var o = Object.getOwnPropertySymbols(e); r && (o = o.filter(function (r) { return Object.getOwnPropertyDescriptor(e, r).enumerable; })), t.push.apply(t, o); } return t; }
function _objectSpread(e) { for (var r = 1; r < arguments.length; r++) { var t = null != arguments[r] ? arguments[r] : {}; r % 2 ? ownKeys(Object(t), !0).forEach(function (r) { defineProperty._defineProperty(e, r, t[r]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(t)) : ownKeys(Object(t)).forEach(function (r) { Object.defineProperty(e, r, Object.getOwnPropertyDescriptor(t, r)); }); } return e; }
var DatePickerTable = function DatePickerTable(props) {
  var _useConfig = hooks_useConfig["default"](),
    classPrefix = _useConfig.classPrefix;
  var value = props.value,
    format = props.format,
    mode = props.mode,
    data = props.data,
    time = props.time,
    onCellClick = props.onCellClick,
    onCellMouseEnter = props.onCellMouseEnter,
    onCellMouseLeave = props.onCellMouseLeave,
    firstDayOfWeek = props.firstDayOfWeek;
  var _useLocaleReceiver = locale_LocalReceiver.useLocaleReceiver("datePicker"),
    _useLocaleReceiver2 = slicedToArray._slicedToArray(_useLocaleReceiver, 2),
    local = _useLocaleReceiver2[0],
    t = _useLocaleReceiver2[1];
  var weekdays = t(local.weekdays);
  var weekAbbreviation = t(local.weekAbbreviation);
  var weekArr = [];
  var wi = firstDayOfWeek - 1;
  var len = weekdays.length;
  while (weekArr.length < len) {
    weekArr.push(weekdays[wi]);
    wi = (wi + len + 1) % len;
  }
  if (mode === "week") weekArr.unshift(weekAbbreviation);
  var showThead = mode === "date" || mode === "week";
  var valueYearWeek = React.useMemo(function () {
    if (mode !== "week" || !value) return {};
    if (Array.isArray(value)) {
      var _startObj$year, _startObj$locale, _startObj$locale$week, _endObj$year, _endObj$locale, _endObj$locale$week;
      if (!value.length) return {};
      var _value$map = value.map(function (v) {
          return v && _common_js_datePicker_format.parseToDayjs(v, format);
        }),
        _value$map2 = slicedToArray._slicedToArray(_value$map, 2),
        startObj = _value$map2[0],
        endObj = _value$map2[1];
      var startYear = startObj === null || startObj === void 0 || (_startObj$year = startObj.year) === null || _startObj$year === void 0 ? void 0 : _startObj$year.call(startObj);
      var startWeek = startObj === null || startObj === void 0 || (_startObj$locale = startObj.locale) === null || _startObj$locale === void 0 || (_startObj$locale = _startObj$locale.call(startObj, local.dayjsLocale)) === null || _startObj$locale === void 0 || (_startObj$locale$week = _startObj$locale.week) === null || _startObj$locale$week === void 0 ? void 0 : _startObj$locale$week.call(_startObj$locale);
      var endYear = endObj === null || endObj === void 0 || (_endObj$year = endObj.year) === null || _endObj$year === void 0 ? void 0 : _endObj$year.call(endObj);
      var endWeek = endObj === null || endObj === void 0 || (_endObj$locale = endObj.locale) === null || _endObj$locale === void 0 || (_endObj$locale = _endObj$locale.call(endObj, local.dayjsLocale)) === null || _endObj$locale === void 0 || (_endObj$locale$week = _endObj$locale.week) === null || _endObj$locale$week === void 0 ? void 0 : _endObj$locale$week.call(_endObj$locale);
      return {
        startYear: startYear,
        startWeek: startWeek,
        endYear: endYear,
        endWeek: endWeek
      };
    }
    var valueObj = _common_js_datePicker_format.parseToDayjs(value, format).locale(local.dayjsLocale);
    return {
      year: valueObj.year(),
      week: valueObj.week()
    };
  }, [mode, value, format]);
  var weekRowClass = function weekRowClass(value2, targetDayjs) {
    if (mode !== "week" || !value2) return {};
    if (Array.isArray(value2)) {
      if (!value2.length) return {};
      var targetYear = targetDayjs.year();
      var targetWeek = targetDayjs.week();
      var isActive = targetYear === valueYearWeek.startYear && targetWeek === valueYearWeek.startWeek || targetYear === valueYearWeek.endYear && targetWeek === valueYearWeek.endWeek;
      var isRange = targetYear >= valueYearWeek.startYear && targetYear <= valueYearWeek.endYear && targetWeek > valueYearWeek.startWeek && targetWeek < valueYearWeek.endWeek;
      return defineProperty._defineProperty(defineProperty._defineProperty({}, "".concat(classPrefix, "-date-picker__table-").concat(mode, "-row--active"), isActive), "".concat(classPrefix, "-date-picker__table-").concat(mode, "-row--range"), isRange);
    }
    return defineProperty._defineProperty({}, "".concat(classPrefix, "-date-picker__table-").concat(mode, "-row--active"), valueYearWeek.year === targetDayjs.year() && valueYearWeek.week === targetDayjs.week());
  };
  return /* @__PURE__ */React__default["default"].createElement("div", {
    className: "".concat(classPrefix, "-date-picker__table"),
    onMouseLeave: function onMouseLeave(e) {
      return onCellMouseLeave === null || onCellMouseLeave === void 0 ? void 0 : onCellMouseLeave({
        e: e
      });
    }
  }, /* @__PURE__ */React__default["default"].createElement("table", null, showThead && /* @__PURE__ */React__default["default"].createElement("thead", null, /* @__PURE__ */React__default["default"].createElement("tr", null, weekArr.map(function (value2, i) {
    return /* @__PURE__ */React__default["default"].createElement("th", {
      key: i
    }, value2);
  }))), /* @__PURE__ */React__default["default"].createElement("tbody", null, data.map(function (row, i) {
    return /* @__PURE__ */React__default["default"].createElement("tr", {
      key: i,
      className: classNames__default["default"]("".concat(classPrefix, "-date-picker__table-").concat(mode, "-row"), _objectSpread({}, weekRowClass(value, row[0].dayjsObj)))
    }, row.map(function (col, j) {
      return /* @__PURE__ */React__default["default"].createElement(datePicker_base_Cell["default"], _objectSpread(_objectSpread({}, col), {}, {
        key: j,
        time: time,
        onClick: onCellClick,
        onMouseEnter: onCellMouseEnter
      }));
    }));
  }))));
};
DatePickerTable.displayName = "DatePickerTable";

exports["default"] = DatePickerTable;
//# sourceMappingURL=Table.js.map
