{"version":3,"file":"TooltipLite.js","sources":["../../src/tooltip/TooltipLite.tsx"],"sourcesContent":["import React, { ReactNode, useState, useRef, useEffect } from 'react';\nimport classnames from 'classnames';\nimport { CSSTransition } from 'react-transition-group';\nimport { StyledProps } from '../common';\nimport useSwitch from '../_util/useSwitch';\nimport useAnimation from '../_util/useAnimation';\nimport Portal from '../common/Portal';\nimport useConfig from '../hooks/useConfig';\nimport getPosition from '../_common/js/utils/getPosition';\nimport { TdTooltipLiteProps } from './type';\nimport { tooltipLiteDefaultProps } from './defaultProps';\nimport { getTransitionParams } from '../popup/utils/transition';\nimport useDefaultProps from '../hooks/useDefaultProps';\n\nexport interface TooltipLiteProps extends TdTooltipLiteProps, StyledProps {\n  children?: ReactNode;\n}\n\nconst DEFAULT_TRANSITION_TIMEOUT = 180;\n\nconst TooltipLite: React.FC<TooltipLiteProps> = (originalProps) => {\n  const props = useDefaultProps<TooltipLiteProps>(originalProps, tooltipLiteDefaultProps);\n  const { style, className, placement, showArrow, theme, children, triggerElement, content, showShadow } = props;\n  const triggerRef = useRef(null);\n  const contentRef = useRef(null);\n  const popupRef = useRef(null);\n  const { classPrefix } = useConfig();\n  const [hover, hoverAction] = useSwitch();\n  const [clientX, setHoverClientX] = useState(0);\n  const [position, setPosition] = useState(null);\n  const { keepFade } = useAnimation();\n\n  useEffect(() => {\n    if (triggerRef.current && contentRef.current) {\n      setPosition(getPosition(triggerRef.current, contentRef.current, placement, clientX));\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [triggerRef.current, contentRef.current, placement, hover]);\n\n  const onSwitchHover = (action: String, e: MouseEvent) => {\n    setHoverClientX(e.clientX);\n    hoverAction.set(action === 'on');\n  };\n\n  const showTipArrow = showArrow && placement !== 'mouse';\n\n  const getTriggerChildren = (children) => {\n    const appendProps = {\n      ref: triggerRef,\n      onMouseEnter: (e) => onSwitchHover('on', e),\n      onMouseLeave: (e) => onSwitchHover('off', e),\n    };\n    if (!React.isValidElement(children)) {\n      return React.cloneElement(<div>{children}</div>, { ...appendProps });\n    }\n    return React.cloneElement(children, { ...appendProps });\n  };\n\n  return (\n    <div>\n      {getTriggerChildren(children || triggerElement)}\n      {hover && (\n        <Portal>\n          <CSSTransition\n            appear\n            timeout={{\n              appear: DEFAULT_TRANSITION_TIMEOUT,\n            }}\n            in={hover}\n            nodeRef={popupRef}\n            {...getTransitionParams({\n              classPrefix,\n              fadeAnimation: keepFade,\n            })}\n          >\n            <div\n              className={classnames(\n                `${classPrefix}-popup`,\n                `${classPrefix}-tooltip`,\n                {\n                  [`${classPrefix}-tooltip--${theme}`]: theme,\n                  [`${classPrefix}-tooltip--noshadow`]: !showShadow,\n                },\n                className,\n              )}\n              style={{\n                position: 'absolute',\n                left: position?.left,\n                top: position?.top,\n              }}\n              data-popper-placement={placement}\n              ref={popupRef}\n            >\n              <div\n                className={classnames(`${classPrefix}-popup__content`, {\n                  [`${classPrefix}-popup__content--arrow`]: showTipArrow,\n                })}\n                ref={contentRef}\n                style={style}\n              >\n                {content}\n                {showTipArrow && <div className={`${classPrefix}-popup__arrow`} />}\n              </div>\n            </div>\n          </CSSTransition>\n        </Portal>\n      )}\n    </div>\n  );\n};\n\nTooltipLite.displayName = 'Tooltiplite';\n\nexport default React.memo(TooltipLite);\n"],"names":["DEFAULT_TRANSITION_TIMEOUT","TooltipLite","originalProps","props","useDefaultProps","tooltipLiteDefaultProps","style","className","placement","showArrow","theme","children","triggerElement","content","showShadow","triggerRef","useRef","contentRef","popupRef","_useConfig","useConfig","classPrefix","_useSwitch","useSwitch","_useSwitch2","_slicedToArray","hover","hoverAction","_useState","useState","_useState2","clientX","setHoverClientX","_useState3","_useState4","position","setPosition","_useAnimation","useAnimation","keepFade","useEffect","current","getPosition","onSwitchHover","action","e","set","showTipArrow","getTriggerChildren","appendProps","ref","onMouseEnter","onMouseLeave","React","isValidElement","cloneElement","createElement","_objectSpread","Portal","CSSTransition","appear","timeout","nodeRef","getTransitionParams","fadeAnimation","classnames","concat","_defineProperty","left","top","displayName","memo"],"mappings":"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"}