{"version":3,"file":"useDrag.js","sources":["../../src/_util/useDrag.ts"],"sourcesContent":["import { useRef, useEffect } from 'react';\n\nexport interface Coordinate {\n  x: number;\n  y: number;\n}\n\ninterface DraggableCallback {\n  (coordinate: Coordinate, event?: MouseEvent): void;\n}\n\ninterface DraggableProps {\n  start?: DraggableCallback;\n  drag?: DraggableCallback;\n  end?: DraggableCallback;\n}\n\nconst useDrag = (ref, options: DraggableProps) => {\n  const { start, end, drag } = options;\n\n  const isDraggingRef = useRef(false);\n\n  const getCoordinate = (event: MouseEvent) => {\n    try {\n      const rect = ref.current?.getBoundingClientRect();\n      const left = event.clientX - rect.left;\n      const top = event.clientY - rect.top;\n      return {\n        y: Math.min(Math.max(0, top), rect.height),\n        x: Math.min(Math.max(0, left), rect.width),\n      };\n    } catch (error) {\n      return {\n        y: null,\n        x: null,\n      };\n    }\n  };\n\n  const handlePointerMove = (e: MouseEvent) => {\n    if (isDraggingRef.current) drag(getCoordinate(e), e);\n  };\n\n  const handlePointerUp = (e: MouseEvent) => {\n    isDraggingRef.current = false;\n    end(getCoordinate(e), e);\n    const element = ref.current;\n    element.removeEventListener('mouseup', handlePointerUp);\n    element.removeEventListener('mousemove', handlePointerMove);\n  };\n\n  const handlePointerDown = (e: MouseEvent) => {\n    isDraggingRef.current = true;\n    start(getCoordinate(e), e);\n    const element = ref.current;\n    element.addEventListener('mouseup', handlePointerUp);\n    element.addEventListener('mousemove', handlePointerMove);\n  };\n\n  useEffect(() => {\n    const element = ref.current;\n    if (element) {\n      element.addEventListener('mousedown', handlePointerDown);\n    }\n    return () => {\n      if (element) {\n        element.removeEventListener('mousedown', handlePointerDown);\n      }\n    };\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n\n  return {\n    isDragging: isDraggingRef.current,\n  };\n};\n\nexport default useDrag;\n"],"names":["useDrag","ref","options","start","end","drag","isDraggingRef","useRef","getCoordinate","event","_ref$current","rect","current","getBoundingClientRect","left","clientX","top","clientY","y","Math","min","max","height","x","width","error","handlePointerMove","e","handlePointerUp","element","removeEventListener","handlePointerDown","addEventListener","useEffect","isDragging"],"mappings":"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"}