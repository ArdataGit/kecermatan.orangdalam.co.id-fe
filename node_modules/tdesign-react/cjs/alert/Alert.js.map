{"version":3,"file":"Alert.js","sources":["../../src/alert/Alert.tsx"],"sourcesContent":["import React, { forwardRef, useRef } from 'react';\nimport classNames from 'classnames';\nimport {\n  CloseIcon as TdCloseIcon,\n  InfoCircleFilledIcon as TdInfoCircleFilledIcon,\n  CheckCircleFilledIcon as TdCheckCircleFilledIcon,\n  ErrorCircleFilledIcon as TdErrorCircleFilledIcon,\n} from 'tdesign-icons-react';\nimport { CSSTransition } from 'react-transition-group';\nimport noop from '../_util/noop';\nimport parseTNode from '../_util/parseTNode';\nimport useConfig from '../hooks/useConfig';\nimport useGlobalIcon from '../hooks/useGlobalIcon';\nimport { useLocaleReceiver } from '../locale/LocalReceiver';\nimport { TdAlertProps } from './type';\nimport { StyledProps } from '../common';\nimport { alertDefaultProps } from './defaultProps';\nimport composeRefs from '../_util/composeRefs';\nimport useDefaultProps from '../hooks/useDefaultProps';\n\nconst transitionTime = 200;\n\nexport interface AlertProps extends TdAlertProps, StyledProps {}\n\nconst Alert = forwardRef<HTMLDivElement, AlertProps>((props, ref) => {\n  const { classPrefix } = useConfig();\n  const [local, t] = useLocaleReceiver('alert');\n  const { CloseIcon, InfoCircleFilledIcon, CheckCircleFilledIcon, ErrorCircleFilledIcon } = useGlobalIcon({\n    CloseIcon: TdCloseIcon,\n    InfoCircleFilledIcon: TdInfoCircleFilledIcon,\n    CheckCircleFilledIcon: TdCheckCircleFilledIcon,\n    ErrorCircleFilledIcon: TdErrorCircleFilledIcon,\n  });\n\n  const {\n    message,\n    title,\n    operation,\n    theme,\n    icon,\n    close,\n    maxLine,\n    onClose,\n    className,\n    onClosed = noop,\n    ...alertProps\n  } = useDefaultProps(props, alertDefaultProps);\n\n  const [closed, setClosed] = React.useState(false);\n  const [collapsed, setCollapsed] = React.useState(false);\n\n  const iconMap = {\n    success: CheckCircleFilledIcon,\n    info: InfoCircleFilledIcon,\n    error: ErrorCircleFilledIcon,\n    warning: ErrorCircleFilledIcon,\n  };\n\n  const handleClose = (e: React.MouseEvent<HTMLDivElement>) => {\n    setClosed(true);\n    onClose?.({ e });\n  };\n\n  const handleCollapse = () => {\n    setCollapsed(!collapsed);\n  };\n\n  const renderIconNode = () => {\n    if (React.isValidElement(icon)) return icon;\n    return React.createElement(iconMap[theme]);\n  };\n\n  const renderMessage = () => {\n    if (+maxLine > 0 && Array.isArray(message)) {\n      return (\n        <div className={`${classPrefix}-alert__description`}>\n          {message.map((item, index) => {\n            if (!collapsed) {\n              if (index < maxLine) {\n                return <div key={index}>{item}</div>;\n              }\n            } else {\n              return <div key={index}>{item}</div>;\n            }\n            return true;\n          })}\n          <div className={`${classPrefix}-alert__collapse`} onClick={handleCollapse}>\n            {!collapsed ? t(local.expandText) : t(local.collapseText)}\n          </div>\n        </div>\n      );\n    }\n    return <div className={`${classPrefix}-alert__description`}>{message}</div>;\n  };\n\n  const renderClose = () => (\n    <div className={`${classPrefix}-alert__close`} onClick={handleClose}>\n      {typeof close === 'boolean' ? <CloseIcon /> : parseTNode(close)}\n    </div>\n  );\n\n  const nodeRef = useRef<HTMLDivElement>();\n\n  return (\n    <CSSTransition\n      in={!closed}\n      unmountOnExit\n      classNames={{\n        exitActive: `${classPrefix}-alert--closing`,\n      }}\n      nodeRef={nodeRef}\n      timeout={transitionTime}\n      onExited={onClosed}\n    >\n      <div\n        ref={composeRefs(ref, nodeRef)}\n        className={classNames(`${classPrefix}-alert`, `${classPrefix}-alert--${theme}`, className)}\n        {...alertProps}\n      >\n        <div className={`${classPrefix}-alert__icon`}>{renderIconNode()}</div>\n        <div className={`${classPrefix}-alert__content`}>\n          {title ? <div className={`${classPrefix}-alert__title`}>{title}</div> : null}\n          <div className={`${classPrefix}-alert__message`}>\n            {renderMessage()}\n            {operation ? <div className={`${classPrefix}-alert__operation`}>{parseTNode(operation)}</div> : null}\n          </div>\n        </div>\n        {close ? renderClose() : null}\n      </div>\n    </CSSTransition>\n  );\n});\n\nAlert.displayName = 'Alert';\n\nexport default Alert;\n"],"names":["transitionTime","Alert","forwardRef","props","ref","_useConfig","useConfig","classPrefix","_useLocaleReceiver","useLocaleReceiver","_useLocaleReceiver2","_slicedToArray","local","t","_useGlobalIcon","useGlobalIcon","CloseIcon","TdCloseIcon","InfoCircleFilledIcon","TdInfoCircleFilledIcon","CheckCircleFilledIcon","TdCheckCircleFilledIcon","ErrorCircleFilledIcon","TdErrorCircleFilledIcon","_useDefaultProps","useDefaultProps","alertDefaultProps","message","title","operation","theme","icon","close","maxLine","onClose","className","_useDefaultProps$onCl","onClosed","noop","alertProps","_objectWithoutProperties","_excluded","_React$useState","React","useState","_React$useState2","closed","setClosed","_React$useState3","_React$useState4","collapsed","setCollapsed","iconMap","success","info","error","warning","handleClose","e","handleCollapse","renderIconNode","isValidElement","createElement","renderMessage","Array","isArray","map","item","index","key","onClick","expandText","collapseText","renderClose","parseTNode","nodeRef","useRef","CSSTransition","unmountOnExit","classNames","exitActive","timeout","onExited","_objectSpread","composeRefs","concat","displayName"],"mappings":"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"}