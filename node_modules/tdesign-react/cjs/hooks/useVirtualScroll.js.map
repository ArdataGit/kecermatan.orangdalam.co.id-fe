{"version":3,"file":"useVirtualScroll.js","sources":["../../src/hooks/useVirtualScroll.ts"],"sourcesContent":["/**\n * 通用虚拟滚动，可支持 Select/List/Table/TreeSelect/Cascader 等组件\n */\nimport { useState, useMemo, useEffect, MutableRefObject, useRef } from 'react';\nimport { TScroll, ScrollToElementParams } from '../common';\nimport useResizeObserver from './useResizeObserver';\n\nexport type UseVirtualScrollParams = {\n  /** 列数据 */\n  data: { [key: string]: any }[];\n  scroll: TScroll;\n};\n\nconst requestAnimationFrame =\n  (typeof window === 'undefined' ? false : window.requestAnimationFrame) || ((cb) => setTimeout(cb, 16.6));\n\nconst useVirtualScroll = (container: MutableRefObject<HTMLElement>, params: UseVirtualScrollParams) => {\n  const { data, scroll } = params;\n  /** 注意测试：数据长度为空；数据长度小于表格高度等情况。即期望只有数据量达到一定程度才允许开启虚拟滚动 */\n  const [visibleData, setVisibleData] = useState<any[]>([]);\n  // 滚动过程中表格顶部占位距离\n  const [translateY, setTranslateY] = useState((data?.length || 0) * (scroll?.rowHeight || 50));\n  // 滚动高度，用于显示滚动条\n  const [scrollHeight, setScrollHeight] = useState(0);\n  const trScrollTopHeightList = useRef<number[]>([]);\n  // 已经通过节点渲染计算出来的各自行高\n  const [trHeightList, setTrHeightList] = useState<number[]>([]);\n  const containerWidth = useRef(0);\n  const containerHeight = useRef(0);\n  const [startAndEndIndex, setStartAndEndIndex] = useState<[number, number]>([0, 15]);\n\n  // 设置初始值\n  const tScroll = useMemo(() => {\n    if (!scroll) return {};\n    return {\n      bufferSize: scroll.bufferSize || 10,\n      isFixedRowHeight: scroll.isFixedRowHeight ?? false,\n      rowHeight: scroll.rowHeight || 47,\n      threshold: scroll.threshold || 100,\n      type: scroll.type,\n    };\n  }, [scroll]);\n\n  // 当前场景是否满足开启虚拟滚动的条件\n  const isVirtualScroll = useMemo(() => tScroll.type === 'virtual' && tScroll.threshold < data.length, [tScroll, data]);\n  const getTrScrollTopHeightList = (trHeightList: number[], containerHeight: number) => {\n    const list: number[] = [];\n    // 大数据场景不建议使用 forEach 一类函数迭代\n    // 当前行滚动高度 = 上一行滚动高度 + 当前行高度 + 容器高度\n    for (let i = 0, len = data.length; i < len; i++) {\n      list[i] = (list[i - 1] || containerHeight) + (trHeightList[i] || tScroll.rowHeight);\n    }\n    return list;\n  };\n\n  const tripleBufferSize = useMemo(() => tScroll.bufferSize * 3, [tScroll.bufferSize]);\n\n  const updateVisibleData = (trScrollTopHeightList: number[], scrollTop: number) => {\n    let currentIndex = -1;\n    // 获取当前滚动到哪一个元素（大数据场景不建议使用 forEach 一类函数迭代）\n    for (let i = 0, len = trScrollTopHeightList.length; i < len; i++) {\n      if (trScrollTopHeightList[i] >= scrollTop) {\n        currentIndex = i;\n        break;\n      }\n    }\n    if (currentIndex < 0) return;\n    const startIndex = Math.min(currentIndex, trScrollTopHeightList.length - tripleBufferSize);\n    const endIndex = startIndex + tripleBufferSize;\n    if (startAndEndIndex.join() !== [startIndex, endIndex].join() && startIndex >= 0) {\n      const tmpVisibleData = data.slice(startIndex, endIndex);\n      setVisibleData(tmpVisibleData);\n      const lastScrollTop = trScrollTopHeightList[startIndex - 1];\n      const top = lastScrollTop > 0 ? lastScrollTop - containerHeight.current : 0;\n      setTranslateY(top);\n      setStartAndEndIndex([startIndex, endIndex]);\n    }\n  };\n\n  // 仅非固定高度场景需要\n  const handleRowMounted = (rowData: any) => {\n    if (!isVirtualScroll || !rowData || tScroll.isFixedRowHeight || !container?.current) return;\n    const trHeight = rowData.ref.offsetHeight;\n    // eslint-disable-next-line\n    const rowIndex = rowData.data.__VIRTUAL_SCROLL_INDEX;\n    const newTrHeightList = trHeightList;\n    if (newTrHeightList[rowIndex] !== trHeight) {\n      newTrHeightList[rowIndex] = trHeight;\n      setTrHeightList(newTrHeightList);\n\n      const scrollTopHeightList = getTrScrollTopHeightList(newTrHeightList, containerHeight.current);\n      trScrollTopHeightList.current = scrollTopHeightList;\n\n      const lastIndex = scrollTopHeightList.length - 1;\n      setScrollHeight(scrollTopHeightList[lastIndex] - containerHeight.current);\n      updateVisibleData(scrollTopHeightList, container.current.scrollTop);\n    }\n  };\n\n  const handleScroll = () => {\n    if (!isVirtualScroll) return;\n    updateVisibleData(trScrollTopHeightList.current, container.current.scrollTop);\n  };\n\n  const refreshVirtualScroll = ([{ contentRect }]: [ResizeObserverEntry]) => {\n    // 如果宽度发生变化，重置滚动位置（高度发生变化时，会触发 container 变化，下方的 watch 会计算）\n    const maxScrollbarWidth = 16;\n    if (Math.abs(contentRect.width - containerWidth.current) > maxScrollbarWidth) {\n      // eslint-disable-next-line\n      container.current.scrollTop = 0;\n      // react container.current.scrollTop 有时候不会触发滚动事件，故而手动触发\n      handleScroll();\n    }\n    containerWidth.current = contentRect.width;\n    containerHeight.current = contentRect.height;\n  };\n\n  const addIndexToData = (data: any[]) => {\n    data.forEach((item, index) => {\n      // eslint-disable-next-line\n      item['__VIRTUAL_SCROLL_INDEX'] = index;\n    });\n  };\n\n  const updateScrollTop = ({ index, top = 0, behavior }: ScrollToElementParams) => {\n    const containerCurrentHeight = containerHeight.current || container.current.getBoundingClientRect().height;\n    const scrollTop = trScrollTopHeightList.current[index] - containerCurrentHeight - top;\n    container.current?.scrollTo({\n      top: scrollTop,\n      behavior: behavior || 'auto',\n    });\n  };\n\n  /**\n   * 滚动到指定元素（对外暴露的方法，谨慎修改）\n   */\n  const scrollToElement = (p: ScrollToElementParams) => {\n    updateScrollTop(p);\n    if (!tScroll.isFixedRowHeight) {\n      requestAnimationFrame(() => {\n        const duration = p.time ?? 60;\n        const timer = setTimeout(() => {\n          updateScrollTop(p);\n          clearTimeout(timer);\n        }, duration);\n      });\n    }\n  };\n\n  useResizeObserver(isVirtualScroll ? container.current : undefined, refreshVirtualScroll);\n\n  // 固定高度场景，可直接通过数据长度计算出最大滚动高度\n  useEffect(\n    () => {\n      if (!isVirtualScroll) {\n        trScrollTopHeightList.current = getTrScrollTopHeightList(\n          trHeightList,\n          container.current?.getBoundingClientRect().height,\n        );\n        return;\n      }\n\n      // 给数据添加下标\n      addIndexToData(data);\n      setScrollHeight(data.length * tScroll.rowHeight);\n      const startIndex = startAndEndIndex[0];\n      const tmpData = data.slice(startIndex, startIndex + tripleBufferSize);\n\n      setVisibleData(tmpData);\n\n      const timer = setTimeout(() => {\n        if (container.current) {\n          const tmpContainerHeight = container.current.getBoundingClientRect().height;\n          containerHeight.current = tmpContainerHeight;\n          const scrollTopHeightList = getTrScrollTopHeightList(trHeightList, tmpContainerHeight);\n          trScrollTopHeightList.current = scrollTopHeightList;\n          clearTimeout(timer);\n        }\n      }, 1);\n    },\n    // eslint-disable-next-line\n    [container, data, tScroll, isVirtualScroll, startAndEndIndex, trHeightList, tripleBufferSize],\n  );\n\n  return {\n    visibleData,\n    translateY,\n    scrollHeight,\n    isVirtualScroll,\n    handleScroll,\n    handleRowMounted,\n    scrollToElement,\n  };\n};\n\nexport type VirtualScrollConfig = ReturnType<typeof useVirtualScroll>;\n\nexport default useVirtualScroll;\n"],"names":["requestAnimationFrame","window","cb","setTimeout","useVirtualScroll","container","params","data","scroll","_useState","useState","_useState2","_slicedToArray","visibleData","setVisibleData","_useState3","length","rowHeight","_useState4","translateY","setTranslateY","_useState5","_useState6","scrollHeight","setScrollHeight","trScrollTopHeightList","useRef","_useState7","_useState8","trHeightList","setTrHeightList","containerWidth","containerHeight","_useState9","_useState10","startAndEndIndex","setStartAndEndIndex","tScroll","useMemo","_scroll$isFixedRowHei","bufferSize","isFixedRowHeight","threshold","type","isVirtualScroll","getTrScrollTopHeightList","list","i","len","tripleBufferSize","updateVisibleData","scrollTop","currentIndex","startIndex","Math","min","endIndex","join","tmpVisibleData","slice","lastScrollTop","top","current","handleRowMounted","rowData","trHeight","ref","offsetHeight","rowIndex","__VIRTUAL_SCROLL_INDEX","newTrHeightList","scrollTopHeightList","lastIndex","handleScroll","refreshVirtualScroll","_ref2","_ref","contentRect","maxScrollbarWidth","abs","width","height","addIndexToData","forEach","item","index","updateScrollTop","_container$current","_ref3$top","behavior","containerCurrentHeight","getBoundingClientRect","scrollTo","scrollToElement","p","_p$time","duration","time","timer","clearTimeout","useResizeObserver","useEffect","_container$current2","tmpData","tmpContainerHeight"],"mappings":"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"}